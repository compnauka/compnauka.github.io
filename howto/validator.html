<!DOCTYPE html>
<html lang="uk">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ topics.json</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>

<body class="bg-gray-100 p-8">
    <div class="max-w-4xl mx-auto">
        <div class="bg-white rounded-2xl shadow-lg p-8">
            <h1 class="text-3xl font-bold text-gray-800 mb-4">üîç –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ topics.json</h1>
            <p class="text-gray-600 mb-6">–í—Å—Ç–∞–≤—Ç–µ –≤–º—ñ—Å—Ç —Ñ–∞–π–ª—É topics.json –Ω–∏–∂—á–µ, —â–æ–± –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –Ω–∞ –ø–æ–º–∏–ª–∫–∏:</p>

            <textarea id="jsonInput" class="w-full h-64 p-4 border-2 border-gray-300 rounded-lg font-mono text-sm"
                placeholder='–í—Å—Ç–∞–≤—Ç–µ —Å—é–¥–∏ –≤–º—ñ—Å—Ç topics.json...'></textarea>

            <button onclick="validateJSON()"
                class="mt-4 bg-indigo-600 text-white px-6 py-3 rounded-lg font-bold hover:bg-indigo-700 transition">
                –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏
            </button>

            <button onclick="autoFixQuotes()"
                class="mt-4 ml-2 bg-green-600 text-white px-6 py-3 rounded-lg font-bold hover:bg-green-700 transition">
                üîß –ê–≤—Ç–æ–≤–∏–ø—Ä–∞–≤–ª–µ–Ω–Ω—è –ª–∞–ø–æ–∫
            </button>

            <div id="result" class="mt-6"></div>
        </div>

        <div class="mt-8 bg-blue-50 border-l-4 border-blue-500 p-6 rounded">
            <h3 class="font-bold text-blue-800 mb-2">üí° –ü—ñ–¥–∫–∞–∑–∫–∞:</h3>
            <ul class="text-sm text-blue-700 space-y-1">
                <li>‚úì –í—Å—ñ ID –º–∞—é—Ç—å –±—É—Ç–∏ —É–Ω—ñ–∫–∞–ª—å–Ω–∏–º–∏</li>
                <li>‚úì –ü—ñ—Å–ª—è –∫–æ–∂–Ω–æ–≥–æ –±–ª–æ–∫—É { } –º–∞—î –±—É—Ç–∏ –∫–æ–º–∞, –∫—Ä—ñ–º –æ—Å—Ç–∞–Ω–Ω—å–æ–≥–æ</li>
                <li>‚úì –í—Å—ñ –ª–∞–ø–∫–∏ –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ "text" –º–∞—é—Ç—å –±—É—Ç–∏ –æ–¥–∏–Ω–∞—Ä–Ω–∏–º–∏ '</li>
                <li>‚úì URL –≤—ñ–¥–µ–æ –º–∞—î –ø–æ—á–∏–Ω–∞—Ç–∏—Å—è –∑ https://</li>
            </ul>
        </div>
    </div>

    <script>
        function autoFixQuotes() {
            const input = document.getElementById('jsonInput');
            const result = document.getElementById('result');
            let content = input.value;

            if (!content.trim()) {
                result.innerHTML = `
                    <div class="bg-yellow-50 border-l-4 border-yellow-500 p-4 rounded">
                        <p class="text-yellow-800">‚ö†Ô∏è –ë—É–¥—å –ª–∞—Å–∫–∞, –≤—Å—Ç–∞–≤—Ç–µ –≤–º—ñ—Å—Ç —Ñ–∞–π–ª—É</p>
                    </div>
                `;
                return;
            }

            try {
                // –°–ø—Ä–æ–±–∞ —Ä–æ–∑–ø–∞—Ä—Å–∏—Ç–∏ –¥–ª—è –≤–∏–∑–Ω–∞—á–µ–Ω–Ω—è –ø—Ä–æ–±–ª–µ–º–Ω–∏—Ö –º—ñ—Å—Ü—å
                const data = JSON.parse(content);

                result.innerHTML = `
                    <div class="bg-blue-50 border-l-4 border-blue-500 p-4 rounded">
                        <p class="text-blue-800">‚ÑπÔ∏è JSON –≤–∂–µ –∫–æ—Ä–µ–∫—Ç–Ω–∏–π, –≤–∏–ø—Ä–∞–≤–ª–µ–Ω–Ω—è –Ω–µ –ø–æ—Ç—Ä—ñ–±–Ω—ñ!</p>
                    </div>
                `;
            } catch (e) {
                // –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ –≤–∏–ø—Ä–∞–≤–ª–µ–Ω–Ω—è –ø–æ–¥–≤—ñ–π–Ω–∏—Ö –ª–∞–ø–æ–∫ —É –ø–æ–ª—ñ "text"
                // –¶–µ —Å–∫–ª–∞–¥–Ω–∏–π –ø—Ä–æ—Ü–µ—Å, —Ç–æ–º—É —Ä–æ–±–∏–º–æ –±–∞–∑–æ–≤–µ –µ–∫—Ä–∞–Ω—É–≤–∞–Ω–Ω—è
                let fixed = content;

                // –ó–Ω–∞—Ö–æ–¥–∏–º–æ –≤—Å—ñ "text": "..." –±–ª–æ–∫–∏ —ñ –∑–∞–º—ñ–Ω—é—î–º–æ " –Ω–∞ ' –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ
                fixed = fixed.replace(/"text":\s*"([^"]*(?:"[^"]*)*?)"/g, (match, textContent) => {
                    // –ó–∞–º—ñ–Ω—é—î–º–æ –ø–æ–¥–≤—ñ–π–Ω—ñ –ª–∞–ø–∫–∏ –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ –Ω–∞ –æ–¥–∏–Ω–∞—Ä–Ω—ñ
                    const cleaned = textContent.replace(/"/g, "'");
                    return `"text": "${cleaned}"`;
                });

                input.value = fixed;

                result.innerHTML = `
                    <div class="bg-green-50 border-l-4 border-green-500 p-4 rounded">
                        <p class="text-green-800 font-bold">‚úÖ –õ–∞–ø–∫–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –≤–∏–ø—Ä–∞–≤–ª–µ–Ω–æ!</p>
                        <p class="text-green-700 text-sm mt-2">–¢–µ–ø–µ—Ä –Ω–∞—Ç–∏—Å–Ω–∏ "–ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏" –¥–ª—è –æ—Å—Ç–∞—Ç–æ—á–Ω–æ—ó –≤–∞–ª—ñ–¥–∞—Ü—ñ—ó.</p>
                    </div>
                `;

                // –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∞ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∞ –ø—ñ—Å–ª—è –≤–∏–ø—Ä–∞–≤–ª–µ–Ω–Ω—è
                setTimeout(validateJSON, 500);
            }
        }

        function validateJSON() {
            const input = document.getElementById('jsonInput').value;
            const result = document.getElementById('result');

            if (!input.trim()) {
                result.innerHTML = `
                    <div class="bg-yellow-50 border-l-4 border-yellow-500 p-4 rounded">
                        <p class="text-yellow-800">‚ö†Ô∏è –ë—É–¥—å –ª–∞—Å–∫–∞, –≤—Å—Ç–∞–≤—Ç–µ –≤–º—ñ—Å—Ç —Ñ–∞–π–ª—É</p>
                    </div>
                `;
                return;
            }

            try {
                const data = JSON.parse(input);

                // –ü–µ—Ä–µ–≤—ñ—Ä–∫–∏
                const errors = [];
                const warnings = [];
                const ids = new Set();

                // –í–∏–∑–Ω–∞—á–µ–Ω–Ω—è —Ñ–æ—Ä–º–∞—Ç—É (—Å—Ç–∞—Ä–∏–π —á–∏ –Ω–æ–≤–∏–π)
                let topics;
                if (Array.isArray(data)) {
                    topics = data;
                    warnings.push('–í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è —Å—Ç–∞—Ä–∏–π —Ñ–æ—Ä–º–∞—Ç. –†–µ–∫–æ–º–µ–Ω–¥—É—î—Ç—å—Å—è –æ–Ω–æ–≤–∏—Ç–∏ –¥–æ –Ω–æ–≤–æ–≥–æ —Ñ–æ—Ä–º–∞—Ç—É –∑ –≤–µ—Ä—Å—ñ—î—é.');
                } else if (data.topics && Array.isArray(data.topics)) {
                    topics = data.topics;
                    if (!data.version) warnings.push('–í—ñ–¥—Å—É—Ç–Ω—î –ø–æ–ª–µ "version"');
                    if (!data.lastUpdated) warnings.push('–í—ñ–¥—Å—É—Ç–Ω—î –ø–æ–ª–µ "lastUpdated"');
                } else {
                    errors.push('–ù–µ–≤—ñ—Ä–Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ JSON. –û—á—ñ–∫—É—î—Ç—å—Å—è –º–∞—Å–∏–≤ —Ç–µ–º –∞–±–æ –æ–±\'—î–∫—Ç –∑ –ø–æ–ª–µ–º "topics"');
                    topics = [];
                }

                if (topics.length > 0) {
                    topics.forEach((topic, index) => {
                        // –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –æ–±–æ–≤'—è–∑–∫–æ–≤–∏—Ö –ø–æ–ª—ñ–≤
                        const required = ['id', 'title', 'category', 'icon', 'short', 'video', 'text'];
                        required.forEach(field => {
                            if (!topic[field]) {
                                errors.push(`–¢–µ–º–∞ ${index + 1}: –≤—ñ–¥—Å—É—Ç–Ω—î –ø–æ–ª–µ "${field}"`);
                            }
                        });

                        // –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —É–Ω—ñ–∫–∞–ª—å–Ω–æ—Å—Ç—ñ ID
                        if (ids.has(topic.id)) {
                            errors.push(`–î—É–±–ª—ñ–∫–∞—Ç ID: ${topic.id}`);
                        }
                        ids.add(topic.id);

                        // –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ URL –≤—ñ–¥–µ–æ
                        if (topic.video && !topic.video.startsWith('https://')) {
                            warnings.push(`–¢–µ–º–∞ "${topic.title}": URL –≤—ñ–¥–µ–æ –º–∞—î –ø–æ—á–∏–Ω–∞—Ç–∏—Å—è –∑ https://`);
                        }

                        // –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –ø–æ–¥–≤—ñ–π–Ω–∏—Ö –ª–∞–ø–æ–∫ —É —Ç–µ–∫—Å—Ç—ñ
                        if (topic.text && topic.text.includes('"')) {
                            warnings.push(`–¢–µ–º–∞ "${topic.title}": —É —Ç–µ–∫—Å—Ç—ñ —î –ø–æ–¥–≤—ñ–π–Ω—ñ –ª–∞–ø–∫–∏ ("), –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π –æ–¥–∏–Ω–∞—Ä–Ω—ñ (')`);
                        }
                    });
                }

                // –í—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç—É
                if (errors.length === 0 && warnings.length === 0) {
                    result.innerHTML = `
                        <div class="bg-green-50 border-l-4 border-green-500 p-4 rounded">
                            <p class="text-green-800 font-bold">‚úÖ –í—Å–µ —á—É–¥–æ–≤–æ!</p>
                            <p class="text-green-700 text-sm mt-2">–ó–Ω–∞–π–¥–µ–Ω–æ —Ç–µ–º: ${topics.length}</p>
                            <p class="text-green-700 text-sm">–§–∞–π–ª –≥–æ—Ç–æ–≤–∏–π –¥–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è üéâ</p>
                        </div>
                    `;
                } else {
                    let html = '';

                    if (errors.length > 0) {
                        html += `
                            <div class="bg-red-50 border-l-4 border-red-500 p-4 rounded mb-4">
                                <p class="text-red-800 font-bold">‚ùå –ó–Ω–∞–π–¥–µ–Ω–æ –ø–æ–º–∏–ª–∫–∏:</p>
                                <ul class="text-red-700 text-sm mt-2 list-disc ml-5">
                                    ${errors.map(e => `<li>${e}</li>`).join('')}
                                </ul>
                            </div>
                        `;
                    }

                    if (warnings.length > 0) {
                        html += `
                            <div class="bg-yellow-50 border-l-4 border-yellow-500 p-4 rounded">
                                <p class="text-yellow-800 font-bold">‚ö†Ô∏è –ü–æ–ø–µ—Ä–µ–¥–∂–µ–Ω–Ω—è:</p>
                                <ul class="text-yellow-700 text-sm mt-2 list-disc ml-5">
                                    ${warnings.map(w => `<li>${w}</li>`).join('')}
                                </ul>
                            </div>
                        `;
                    }

                    result.innerHTML = html;
                }

            } catch (e) {
                result.innerHTML = `
                    <div class="bg-red-50 border-l-4 border-red-500 p-4 rounded">
                        <p class="text-red-800 font-bold">‚ùå JSON –Ω–µ –≤–∞–ª—ñ–¥–Ω–∏–π!</p>
                        <p class="text-red-700 text-sm mt-2">–ü–æ–º–∏–ª–∫–∞: ${e.message}</p>
                        <p class="text-red-600 text-xs mt-3">–ù–∞–π—á–∞—Å—Ç—ñ—à—ñ –ø—Ä–∏—á–∏–Ω–∏:</p>
                        <ul class="text-red-600 text-xs mt-1 list-disc ml-5">
                            <li>–ó–∞–±—É—Ç–∞ –∫–æ–º–∞ –ø—ñ—Å–ª—è –±–ª–æ–∫—É { }</li>
                            <li>–ó–∞–π–≤–∞ –∫–æ–º–∞ –ø–µ—Ä–µ–¥ ]</li>
                            <li>–ù–µ–∑–∞–∫—Ä–∏—Ç–∞ –ª–∞–ø–∫–∞ –∞–±–æ –¥—É–∂–∫–∞</li>
                            <li>–í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –ø–æ–¥–≤—ñ–π–Ω–∏—Ö –ª–∞–ø–æ–∫ " –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ "text"</li>
                        </ul>
                    </div>
                `;
            }
        }

        // –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∞ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∞ –ø—Ä–∏ –≤–≤–µ–¥–µ–Ω–Ω—ñ (–∑ –∑–∞—Ç—Ä–∏–º–∫–æ—é)
        let timeout;
        document.getElementById('jsonInput').addEventListener('input', () => {
            clearTimeout(timeout);
            timeout = setTimeout(validateJSON, 1000);
        });
    </script>
</body>

</html>