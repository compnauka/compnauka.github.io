<!DOCTYPE html>
<html lang="uk">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—è ‚Äî –ö–æ—Ç–∏–≥–æ—Ä–æ—à–∫–æ</title>
<script src="https://cdn.tailwindcss.com"></script>
<link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&family=Open+Sans:wght@600;700&display=swap" rel="stylesheet" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" />
<link rel="stylesheet" href="css/styles.css" />
</head>
<body class="bg-gradient-to-br from-blue-900 to-purple-700 min-h-screen p-4 font-sans flex items-center justify-center">

<div class="container mx-auto max-w-md">
  <!-- –§–æ—Ä–º–∞ –≤—Ö–æ–¥—É/—Ä–µ—î—Å—Ç—Ä–∞—Ü—ñ—ó -->
  <div class="bg-white rounded-2xl p-6 md:p-8 shadow-2xl">
    
    <!-- –õ–æ–≥–æ—Ç–∏–ø -->
    <div class="text-center mb-6">
      <h1 class="font-display text-4xl text-yellow-500 mb-2">ü¶∏ –ö–æ—Ç–∏–≥–æ—Ä–æ—à–∫–æ</h1>
      <p class="text-gray-600">–£–≤—ñ–π–¥–∏, —â–æ–± –∑–±–µ—Ä—ñ–≥–∞—Ç–∏ –ø—Ä–æ–≥—Ä–µ—Å!</p>
    </div>

    <!-- Tabs -->
    <div class="flex gap-2 mb-6">
      <button id="tabLogin" class="tab-btn flex-1 bg-blue-500 text-white py-2 rounded-lg font-bold transition">
        –í—Ö—ñ–¥
      </button>
      <button id="tabRegister" class="tab-btn flex-1 bg-gray-200 text-gray-700 py-2 rounded-lg font-bold transition">
        –†–µ—î—Å—Ç—Ä–∞—Ü—ñ—è
      </button>
    </div>

    <!-- –§–æ—Ä–º–∞ –≤—Ö–æ–¥—É -->
    <form id="loginForm" class="space-y-4">
      <div>
        <label class="block text-gray-700 font-medium mb-2">Email</label>
        <input type="email" id="loginEmail" required 
               class="w-full px-4 py-2 border-2 border-gray-300 rounded-lg focus:border-blue-500 focus:outline-none"
               placeholder="—Ç–≤—ñ–π@email.com">
      </div>
      
      <div>
        <label class="block text-gray-700 font-medium mb-2">–ü–∞—Ä–æ–ª—å</label>
        <input type="password" id="loginPassword" required 
               class="w-full px-4 py-2 border-2 border-gray-300 rounded-lg focus:border-blue-500 focus:outline-none"
               placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢">
      </div>

      <button type="submit" class="btn-3d w-full bg-blue-500 text-white py-3 rounded-lg font-bold text-lg [--shadow-color:theme(colors.blue.700)] hover:bg-blue-400">
        <i class="fas fa-sign-in-alt mr-2"></i>–£–≤—ñ–π—Ç–∏
      </button>

      <button type="button" id="forgotPassword" class="w-full text-blue-600 text-sm hover:underline">
        –ó–∞–±—É–ª–∏ –ø–∞—Ä–æ–ª—å?
      </button>
    </form>

    <!-- –§–æ—Ä–º–∞ —Ä–µ—î—Å—Ç—Ä–∞—Ü—ñ—ó -->
    <form id="registerForm" class="space-y-4 hidden">
      <div>
        <label class="block text-gray-700 font-medium mb-2">–Ü–º'—è –≥—Ä–∞–≤—Ü—è</label>
        <input type="text" id="registerName" required 
               class="w-full px-4 py-2 border-2 border-gray-300 rounded-lg focus:border-blue-500 focus:outline-none"
               placeholder="–ö–æ—Ç–∏–≥–æ—Ä–æ—à–æ–∫">
      </div>

      <div>
        <label class="block text-gray-700 font-medium mb-2">Email</label>
        <input type="email" id="registerEmail" required 
               class="w-full px-4 py-2 border-2 border-gray-300 rounded-lg focus:border-blue-500 focus:outline-none"
               placeholder="—Ç–≤—ñ–π@email.com">
      </div>
      
      <div>
        <label class="block text-gray-700 font-medium mb-2">–ü–∞—Ä–æ–ª—å (–º—ñ–Ω—ñ–º—É–º 6 —Å–∏–º–≤–æ–ª—ñ–≤)</label>
        <input type="password" id="registerPassword" required minlength="6"
               class="w-full px-4 py-2 border-2 border-gray-300 rounded-lg focus:border-blue-500 focus:outline-none"
               placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢">
      </div>

      <button type="submit" class="btn-3d w-full bg-green-500 text-white py-3 rounded-lg font-bold text-lg [--shadow-color:theme(colors.green.700)] hover:bg-green-400">
        <i class="fas fa-user-plus mr-2"></i>–ó–∞—Ä–µ—î—Å—Ç—Ä—É–≤–∞—Ç–∏—Å—è
      </button>
    </form>

    <!-- –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ñ –º–µ—Ç–æ–¥–∏ –≤—Ö–æ–¥—É -->
    <div class="mt-6">
      <div class="relative">
        <div class="absolute inset-0 flex items-center">
          <div class="w-full border-t border-gray-300"></div>
        </div>
        <div class="relative flex justify-center text-sm">
          <span class="px-2 bg-white text-gray-500">–ê–±–æ</span>
        </div>
      </div>

      <div class="mt-4 space-y-3">
        <button id="googleLogin" class="btn-3d w-full bg-white border-2 border-gray-300 text-gray-700 py-3 rounded-lg font-bold flex items-center justify-center gap-2 hover:bg-gray-50 [--shadow-color:theme(colors.gray.400)]">
          <i class="fab fa-google text-red-500 text-xl"></i>
          –£–≤—ñ–π—Ç–∏ —á–µ—Ä–µ–∑ Google
        </button>

        <button id="guestLogin" class="w-full bg-gray-100 text-gray-700 py-2 rounded-lg hover:bg-gray-200 transition">
          <i class="fas fa-user-secret mr-2"></i>–ü—Ä–æ–¥–æ–≤–∂–∏—Ç–∏ —è–∫ –≥—ñ—Å—Ç—å
        </button>
      </div>
    </div>

    <!-- –ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –ø—Ä–æ –ø–æ–º–∏–ª–∫—É/—É—Å–ø—ñ—Ö -->
    <div id="authMessage" class="hidden mt-4 p-3 rounded-lg text-sm text-center"></div>

    <!-- –ü–æ—Å–∏–ª–∞–Ω–Ω—è –Ω–∞ –≥—Ä—É -->
    <div class="text-center mt-6">
      <a href="index.html" class="text-blue-600 hover:underline text-sm">
        <i class="fas fa-arrow-left mr-1"></i>–ü–æ–≤–µ—Ä–Ω—É—Ç–∏—Å—è –¥–æ –≥—Ä–∏
      </a>
    </div>
  </div>
</div>

<script type="module">
import { authManager } from './js/auth.js';

// –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è
authManager.init();

// –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —á–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –≤–∂–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–∏–π
authManager.onAuthChange((user) => {
  if (user && !user.isAnonymous) {
    // –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è—î–º–æ –Ω–∞ –≥—Ä—É
    window.location.href = 'index.html';
  }
});

// –ï–ª–µ–º–µ–Ω—Ç–∏
const tabLogin = document.getElementById('tabLogin');
const tabRegister = document.getElementById('tabRegister');
const loginForm = document.getElementById('loginForm');
const registerForm = document.getElementById('registerForm');
const authMessage = document.getElementById('authMessage');

// –ü–µ—Ä–µ–º–∏–∫–∞–Ω–Ω—è —Ç–∞–±—ñ–≤
tabLogin.addEventListener('click', () => {
  tabLogin.classList.add('bg-blue-500', 'text-white');
  tabLogin.classList.remove('bg-gray-200', 'text-gray-700');
  tabRegister.classList.add('bg-gray-200', 'text-gray-700');
  tabRegister.classList.remove('bg-blue-500', 'text-white');
  loginForm.classList.remove('hidden');
  registerForm.classList.add('hidden');
  hideMessage();
});

tabRegister.addEventListener('click', () => {
  tabRegister.classList.add('bg-blue-500', 'text-white');
  tabRegister.classList.remove('bg-gray-200', 'text-gray-700');
  tabLogin.classList.add('bg-gray-200', 'text-gray-700');
  tabLogin.classList.remove('bg-blue-500', 'text-white');
  registerForm.classList.remove('hidden');
  loginForm.classList.add('hidden');
  hideMessage();
});

// –í—Ö—ñ–¥
loginForm.addEventListener('submit', async (e) => {
  e.preventDefault();
  const email = document.getElementById('loginEmail').value;
  const password = document.getElementById('loginPassword').value;

  showMessage('–í—Ö—ñ–¥...', 'info');

  const result = await authManager.login(email, password);
  
  if (result.success) {
    showMessage('–£—Å–ø—ñ—à–Ω–∏–π –≤—Ö—ñ–¥! –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω—è...', 'success');
    setTimeout(() => window.location.href = 'index.html', 1000);
  } else {
    showMessage(result.error, 'error');
  }
});

// –†–µ—î—Å—Ç—Ä–∞—Ü—ñ—è
registerForm.addEventListener('submit', async (e) => {
  e.preventDefault();
  const displayName = document.getElementById('registerName').value;
  const email = document.getElementById('registerEmail').value;
  const password = document.getElementById('registerPassword').value;

  showMessage('–†–µ—î—Å—Ç—Ä–∞—Ü—ñ—è...', 'info');

  const result = await authManager.register({ email, password, displayName });
  
  if (result.success) {
    showMessage('–†–µ—î—Å—Ç—Ä–∞—Ü—ñ—è —É—Å–ø—ñ—à–Ω–∞! –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω—è...', 'success');
    setTimeout(() => window.location.href = 'index.html', 1000);
  } else {
    showMessage(result.error, 'error');
  }
});

// Google –≤—Ö—ñ–¥
document.getElementById('googleLogin').addEventListener('click', async () => {
  showMessage('–í—ñ–¥–∫—Ä–∏—Ç—Ç—è Google –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—ó...', 'info');
  
  const result = await authManager.loginWithGoogle();
  
  if (result.success) {
    showMessage('–£—Å–ø—ñ—à–Ω–∏–π –≤—Ö—ñ–¥! –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω—è...', 'success');
    setTimeout(() => window.location.href = 'index.html', 1000);
  } else {
    showMessage(result.error, 'error');
  }
});

// –ì–æ—Å—Ç—å–æ–≤–∏–π –≤—Ö—ñ–¥
document.getElementById('guestLogin').addEventListener('click', async () => {
  showMessage('–í—Ö—ñ–¥ —è–∫ –≥—ñ—Å—Ç—å...', 'info');
  
  const result = await authManager.loginAnonymously();
  
  if (result.success) {
    window.location.href = 'index.html';
  } else {
    showMessage(result.error, 'error');
  }
});

// –í—ñ–¥–Ω–æ–≤–ª–µ–Ω–Ω—è –ø–∞—Ä–æ–ª—é
document.getElementById('forgotPassword').addEventListener('click', async () => {
  const email = document.getElementById('loginEmail').value;
  
  if (!email) {
    showMessage('–í–≤–µ–¥—ñ—Ç—å email –¥–ª—è –≤—ñ–¥–Ω–æ–≤–ª–µ–Ω–Ω—è –ø–∞—Ä–æ–ª—é', 'error');
    return;
  }

  showMessage('–ù–∞–¥—Å–∏–ª–∞–Ω–Ω—è –ª–∏—Å—Ç–∞...', 'info');
  
  const result = await authManager.resetPassword(email);
  
  if (result.success) {
    showMessage('–õ–∏—Å—Ç –¥–ª—è –≤—ñ–¥–Ω–æ–≤–ª–µ–Ω–Ω—è –ø–∞—Ä–æ–ª—é –Ω–∞–¥—ñ—Å–ª–∞–Ω–æ!', 'success');
  } else {
    showMessage(result.error, 'error');
  }
});

// –ü–æ–∫–∞–∑ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è
function showMessage(text, type) {
  const colors = {
    success: 'bg-green-100 text-green-800 border border-green-300',
    error: 'bg-red-100 text-red-800 border border-red-300',
    info: 'bg-blue-100 text-blue-800 border border-blue-300'
  };

  authMessage.className = `mt-4 p-3 rounded-lg text-sm text-center ${colors[type] || colors.info}`;
  authMessage.textContent = text;
  authMessage.classList.remove('hidden');
}

function hideMessage() {
  authMessage.classList.add('hidden');
}
</script>
</body>
</html>
