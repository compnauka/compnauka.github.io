<!DOCTYPE html>
<html lang="uk">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover, user-scalable=no" />
<title>–ö–æ—Ç–∏–≥–æ—Ä–æ—à–∫–æ ‚Äî –ù–∞–≤—á–∞–ª—å–Ω–∞ –≥—Ä–∞ –∑ –∞–ª–≥–æ—Ä–∏—Ç–º–∞–º–∏</title>
<script src="https://cdn.tailwindcss.com"></script>
<script>
tailwind.config = {
  theme: {
    extend: {
      fontFamily: {
        sans: ['Roboto','-apple-system','BlinkMacSystemFont','Segoe UI','Helvetica','Arial','sans-serif'],
        display: ['Open Sans','Roboto','sans-serif']
      },
      screens: { xs: '380px' }
    }
  }
};
</script>
<link rel="preconnect" href="https://fonts.googleapis.com" />
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
<link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700;900&family=Open+Sans:wght@600;700;800&display=swap" rel="stylesheet" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" />
<link rel="modulepreload" href="js/game.js" />
<link rel="modulepreload" href="js/ui.js" />
<link rel="modulepreload" href="js/grid.js" />
<link rel="modulepreload" href="js/battle.js" />
<link rel="modulepreload" href="js/commands.js" />
<link rel="modulepreload" href="js/levels.js" />
<link rel="modulepreload" href="js/storage.js" />
<link rel="modulepreload" href="js/sound.js" />
<link rel="prefetch" href="leaderboard.html" as="document" />
<link rel="prefetch" href="story.html" as="document" />
<link rel="prefetch" href="algorithms.html" as="document" />
<link rel="stylesheet" href="css/styles.css" />
</head>
<body class="bg-gradient-to-br from-blue-900 to-blue-700 min-h-screen font-sans">

<div id="globalLoader" class="loading-screen" role="status" aria-live="polite">
  <div class="loading-spinner" aria-hidden="true"></div>
  <p class="loading-text">–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –≥—Ä–∏...</p>
  <p class="loading-subtext">–ì–æ—Ç—É—î–º–æ –ø—Ä–∏–≥–æ–¥–∏ –¥–ª—è –ö–æ—Ç–∏–≥–æ—Ä–æ—à–∫–∞</p>
</div>

<div class="game-shell flex flex-col min-h-screen w-full">
  <header class="game-header w-full">
    <div class="w-full px-3 sm:px-6">
      <div class="bg-white/90 backdrop-blur rounded-2xl p-3 md:p-4 shadow-2xl w-full mt-2">
        <div class="flex flex-col gap-4 lg:flex-row lg:items-center lg:justify-between">
          <div class="flex-1 text-center lg:text-left">
            <h1 class="font-display text-2xl xs:text-3xl md:text-4xl text-yellow-500 drop-shadow-lg leading-tight">ü¶∏ –ö–æ—Ç–∏–≥–æ—Ä–æ—à–∫–æ üêâ</h1>
            <p class="text-gray-700 text-xs xs:text-sm md:text-base mt-1">–°—Ç–≤–æ—Ä–∏ –∞–ª–≥–æ—Ä–∏—Ç–º —ñ –∑–¥–æ–ª–∞–π –º–æ–Ω—Å—Ç—Ä—ñ–≤!</p>
            <div class="flex gap-3 mt-2 justify-center lg:justify-start">
              <a href="story.html" class="text-blue-600 hover:text-blue-800 text-sm underline">üìñ –õ–µ–≥–µ–Ω–¥–∞</a>
              <a href="algorithms.html" class="text-blue-600 hover:text-blue-800 text-sm underline">üß† –ê–ª–≥–æ—Ä–∏—Ç–º–∏</a>
            </div>
          </div>

          <div class="flex flex-col sm:flex-row sm:items-center gap-3 lg:gap-5">
            <section class="level-info bg-gradient-to-br from-purple-600 to-indigo-700 p-2.5 md:p-3 rounded-2xl text-white shadow-lg">
              <div class="flex items-center justify-between gap-2 mb-2">
                <h2 class="font-display text-lg md:text-2xl">üè∞ –†—ñ–≤–µ–Ω—å <span id="levelNum">1</span></h2>
                <div class="flex gap-1.5">
                  <button id="soundToggle" class="btn-3d text-white rounded-lg p-1.5 text-base bg-white/20 hover:bg-white/30" aria-pressed="false" aria-label="–ü–µ—Ä–µ–º–∫–Ω—É—Ç–∏ –∑–≤—É–∫" style="--shadow-color:rgba(0,0,0,.3)">
                    <i class="fas fa-volume-up w-4 h-4" id="soundIcon" aria-hidden="true"></i>
                  </button>
                  <button id="fullscreenToggle" class="btn-3d text-white rounded-lg p-1.5 text-base bg-white/20 hover:bg-white/30" aria-label="–ü–æ–≤–Ω–æ–µ–∫—Ä–∞–Ω–Ω–∏–π —Ä–µ–∂–∏–º" style="--shadow-color:rgba(0,0,0,.3)">
                    <i class="fas fa-expand w-4 h-4" id="fullscreenIcon" aria-hidden="true"></i>
                  </button>
                </div>
              </div>
              <p class="level-desc text-xs md:text-sm mb-2 text-center" id="levelDesc"></p>
              <div class="stats-bar flex gap-1.5 justify-center flex-wrap text-xs md:text-sm">
                <div class="stat bg-white/20 rounded-lg px-2 py-1 flex items-center gap-1">‚öîÔ∏è <span id="damage">0</span></div>
                <div class="stat bg-white/20 rounded-lg px-2 py-1 flex items-center gap-1">üõ°Ô∏è <span id="armor">0</span></div>
                <div class="stat bg-white/20 rounded-lg px-2 py-1 flex items-center gap-1">‚ù§Ô∏è <span id="health">100</span></div>
                <div class="stat bg-white/20 rounded-lg px-2 py-1 flex items-center gap-1 font-display">üéØ <span id="parGold">?</span>ü•á</div>
              </div>
            </section>

            <div class="flex flex-col items-center gap-y-2 w-full sm:w-auto">
              <div id="userProfile" class="hidden bg-white/80 backdrop-blur rounded-xl p-2 shadow-md w-full">
                <div class="flex items-center gap-2">
                  <div id="userAvatar" class="text-2xl">üë®‚Äçüíª</div>
                  <div>
                    <p id="userName" class="font-bold text-gray-800 text-sm leading-tight">–ì—Ä–∞–≤–µ—Ü—å</p>
                    <div class="flex gap-2 text-xs">
                      <a href="leaderboard.html" class="text-blue-600 hover:underline">üèÜ –†–µ–π—Ç–∏–Ω–≥</a>
                      <button id="logoutBtn" class="text-red-600 hover:underline hidden">–í–∏–π—Ç–∏</button>
                    </div>
                  </div>
                </div>
              </div>

              <button id="loginBtn" class="btn-3d bg-green-500 text-white px-4 py-2 rounded-lg font-bold text-sm w-full [--shadow-color:theme(colors.green.700)] hover:bg-green-400">
                <i class="fas fa-sign-in-alt mr-1"></i>–£–≤—ñ–π—Ç–∏
              </button>
            </div>
          </div>
        </div>
        <nav class="header-links" aria-label="–î–æ–¥–∞—Ç–∫–æ–≤—ñ —Å—Ç–æ—Ä—ñ–Ω–∫–∏">
          <a href="story.html" class="text-blue-600 hover:text-blue-800 text-xs sm:text-sm font-semibold">üìñ –õ–µ–≥–µ–Ω–¥–∞</a>
          <a href="algorithms.html" class="text-blue-600 hover:text-blue-800 text-xs sm:text-sm font-semibold">üß† –ê–ª–≥–æ—Ä–∏—Ç–º–∏</a>
        </nav>
      </div>
    </div>
  </header>

  <main class="game-main flex-1 w-full">
    <div class="w-full px-2 sm:px-4 py-3 md:py-5">
      <div class="editor-grid grid grid-cols-1 gap-3 md:gap-4 xl:gap-6 lg:grid-cols-[minmax(0,1fr)_minmax(0,0.85fr)_minmax(0,1.05fr)]">
        <section class="panel panel--map" aria-label="–ö–∞—Ä—Ç–∞ –ø—Ä–∏–≥–æ–¥">
          <h3 class="font-display text-xl md:text-2xl text-center text-indigo-600 mb-3">üó∫Ô∏è –ö–∞—Ä—Ç–∞ –ø—Ä–∏–≥–æ–¥</h3>
          <div class="map-wrapper">
            <div class="mx-auto" id="grid" role="grid" aria-label="–°—ñ—Ç–∫–∞ –∫–∞—Ä—Ç–∏"></div>
          </div>
          <div class="legend grid grid-cols-2 sm:grid-cols-3 gap-1.5 text-xs mt-3">
            <div class="legend-item flex items-center gap-1 bg-white p-1 rounded-md shadow-sm">ü¶∏ –ö–æ—Ç–∏–≥–æ—Ä–æ—à–∫–æ</div>
            <div class="legend-item flex items-center gap-1 bg-white p-1 rounded-md shadow-sm">üíÄ –ú–æ–Ω—Å—Ç—Ä</div>
            <div class="legend-item flex items-center gap-1 bg-white p-1 rounded-md shadow-sm">‚öîÔ∏è –ó–±—Ä–æ—è</div>
            <div class="legend-item flex items-center gap-1 bg-white p-1 rounded-md shadow-sm">üõ°Ô∏è –ë—Ä–æ–Ω—è</div>
            <div class="legend-item flex items-center gap-1 bg-white p-1 rounded-md shadow-sm">üß™ –ó—ñ–ª–ª—è</div>
            <div class="legend-item flex items-center gap-1 bg-white p-1 rounded-md shadow-sm">üå≤ –ü–µ—Ä–µ—à–∫–æ–¥–∞</div>
          </div>
        </section>

        <section class="panel panel--palette" aria-label="–ö–æ–º–∞–Ω–¥–∏">
          <h3 class="font-display text-xl md:text-2xl text-center text-indigo-600 mb-3">üß± –ö–æ–º–∞–Ω–¥–∏</h3>
          <p class="palette-hint text-xs sm:text-sm text-slate-600 mb-3 text-center">
            –ü–µ—Ä–µ—Ç—è–≥–Ω–∏ –±–ª–æ–∫ —É –ø–æ–ª–µ –∞–ª–≥–æ—Ä–∏—Ç–º—É –∞–±–æ –ø—Ä–æ—Å—Ç–æ –Ω–∞—Ç–∏—Å–Ω–∏, —â–æ–± –¥–æ–¥–∞—Ç–∏ –π–æ–≥–æ –≤ –∫—ñ–Ω–µ—Ü—å.
          </p>
          <div id="commandPalette" class="command-palette" role="listbox">
            <div class="palette-section" aria-hidden="true">–ö—Ä–æ–∫–∏ —Ä—É—Ö—É</div>
            <button type="button" class="palette-block palette-block--move hidden-by-level" data-visible-from="0" data-command-type="move" data-direction="right" draggable="true">
              <span class="palette-block__icon"><i class="fas fa-arrow-right"></i></span>
              <span class="palette-block__label">–ô—Ç–∏ –ø—Ä–∞–≤–æ—Ä—É—á</span>
            </button>
            <button type="button" class="palette-block palette-block--move hidden-by-level" data-visible-from="1" data-command-type="move" data-direction="up" draggable="true">
              <span class="palette-block__icon"><i class="fas fa-arrow-up"></i></span>
              <span class="palette-block__label">–ô—Ç–∏ –≤–≥–æ—Ä—É</span>
            </button>
            <button type="button" class="palette-block palette-block--move hidden-by-level" data-visible-from="1" data-command-type="move" data-direction="down" draggable="true">
              <span class="palette-block__icon"><i class="fas fa-arrow-down"></i></span>
              <span class="palette-block__label">–ô—Ç–∏ –≤–Ω–∏–∑</span>
            </button>
            <button type="button" class="palette-block palette-block--move hidden-by-level" data-visible-from="1" data-command-type="move" data-direction="left" draggable="true">
              <span class="palette-block__icon"><i class="fas fa-arrow-left"></i></span>
              <span class="palette-block__label">–ô—Ç–∏ –ª—ñ–≤–æ—Ä—É—á</span>
            </button>
            <div class="palette-section" aria-hidden="true">–ü–æ–≤—Ç–æ—Ä–µ–Ω–Ω—è</div>
            <button type="button" class="palette-block palette-block--loop hidden-by-level" data-visible-from="4" data-command-type="loop" draggable="true">
              <span class="palette-block__icon"><i class="fas fa-redo"></i></span>
              <span class="palette-block__label">–¶–∏–∫–ª –ø–æ–≤—Ç–æ—Ä–∏—Ç–∏</span>
              <span class="palette-block__note">–ü–µ—Ä–µ—Ç—è–≥–Ω–∏ –∫–æ–º–∞–Ω–¥–∏ –≤—Å–µ—Ä–µ–¥–∏–Ω—É</span>
            </button>
          </div>
        </section>

        <section class="panel panel--program" aria-label="–¢–≤—ñ–π –∞–ª–≥–æ—Ä–∏—Ç–º">
          <h3 class="font-display text-xl md:text-2xl text-center text-indigo-600 mb-3">üíª –¢–≤—ñ–π –∞–ª–≥–æ—Ä–∏—Ç–º</h3>
          <div class="workspace-intro text-xs sm:text-sm text-slate-600 mb-2 text-center">
            –ü–æ—á–∏–Ω–∞–π –∑ –ø–æ—Ä–æ–∂–Ω—å–æ–≥–æ –ø–æ–ª—è, –¥–æ–¥–∞–≤–∞–π –∫—Ä–æ–∫–∏ –π –ø–µ—Ä–µ—Ç—è–≥—É–π —ó—Ö, —â–æ–±–∏ –∑–º—ñ–Ω—é–≤–∞—Ç–∏ –ø–æ—Ä—è–¥–æ–∫.
          </div>
          <div class="workspace-board" id="commandList" aria-live="polite"></div>
          <div class="workspace-controls grid grid-cols-2 gap-2 mt-3">
            <button class="control-btn btn-3d font-display text-white rounded-xl py-2.5 text-base md:text-xl bg-green-500 [--shadow-color:theme(colors.green.700)] hover:bg-green-400" id="btnRun">
              <i class="fas fa-play mr-2"></i>–°—Ç–∞—Ä—Ç
            </button>
            <button class="control-btn btn-3d font-display text-white rounded-xl py-2.5 text-base md:text-xl bg-red-500 [--shadow-color:theme(colors.red.700)] hover:bg-red-400" id="btnClear">
              <i class="fas fa-trash mr-2"></i>–û—á–∏—Å—Ç–∏—Ç–∏
            </button>
          </div>
          <div class="message hidden text-center p-2.5 rounded-lg mt-3 text-sm md:text-lg font-bold" id="message" role="status" aria-live="polite"></div>
        </section>
      </div>

      <section class="battle-scene hidden bg-gradient-to-br from-gray-800 to-black text-white rounded-2xl p-4 mt-4 md:mt-6" id="battleScene" aria-label="–°—Ü–µ–Ω–∞ –±–æ—é">
        <h2 class="font-display text-2xl md:text-3xl text-center text-yellow-400 mb-4">üí• –ë–Ü–ô! üí•</h2>
        <div class="battle-characters flex justify-around items-center flex-wrap gap-4 mb-4">
          <div class="character text-center w-32 md:w-36">
            <div class="character-icon text-5xl md:text-7xl">ü¶∏</div>
            <div class="font-bold text-base md:text-lg"><strong>–ö–æ—Ç–∏–≥–æ—Ä–æ—à–∫–æ</strong></div>
            <div class="text-xs md:text-sm">‚ù§Ô∏è <span id="heroHealthText">100</span></div>
            <div class="health-bar bg-gray-600 h-4 md:h-5 rounded-full overflow-hidden mt-1 shadow-inner">
              <div class="health-fill hero-health h-full rounded-full bg-gradient-to-r from-green-400 to-green-600 transition-all duration-500" id="heroHealthBar" style="width:100%"></div>
            </div>
          </div>
          <div class="text-3xl md:text-5xl font-display text-yellow-400">‚ö°</div>
          <div class="character text-center w-32 md:w-36">
            <div class="character-icon text-5xl md:text-7xl" id="monsterIcon">üíÄ</div>
            <div class="font-bold text-base md:text-lg"><strong id="monsterName">–ú–æ–Ω—Å—Ç—Ä</strong></div>
            <div class="text-xs md:text-sm">‚ù§Ô∏è <span id="monsterHealthText">50</span></div>
            <div class="health-bar bg-gray-600 h-4 md:h-5 rounded-full overflow-hidden mt-1 shadow-inner">
              <div class="health-fill h-full rounded-full bg-gradient-to-r from-red-400 to-red-600 transition-all duration-500" id="monsterHealthBar" style="width:100%"></div>
            </div>
          </div>
        </div>
        <div class="battle-log bg-white/10 rounded-lg p-3 min-h-[80px] max-h-[180px] overflow-y-auto text-xs md:text-sm text-left font-mono" id="battleLog" aria-live="polite"></div>
      </section>
    </div>
  </main>
</div>

<!-- –ú–æ–¥–∞–ª—å–Ω—ñ –≤—ñ–∫–Ω–∞ -->
<div id="tutorialModalBackdrop" class="fixed inset-0 bg-black/60 z-40 hidden" aria-hidden="true"></div>
<div id="tutorialModal" class="fixed top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 bg-white p-4 md:p-6 rounded-2xl shadow-2xl z-50 w-11/12 max-w-md hidden" role="dialog" aria-modal="true" aria-labelledby="tutorialTitle">
  <h2 id="tutorialTitle" class="font-display text-2xl md:text-3xl text-yellow-500 text-center mb-3 md:mb-4">üîÅ –ù–æ–≤–∞ —Å–∏–ª–∞: —Ü–∏–∫–ª–∏! üîÅ</h2>
  <p class="text-gray-700 mb-3 md:mb-4 text-center text-sm md:text-base">–¶–∏–∫–ª–∏ –¥–æ–∑–≤–æ–ª—è—é—Ç—å –ø–æ–≤—Ç–æ—Ä–∏—Ç–∏ –æ–¥–∏–Ω —ñ —Ç–æ–π —Å–∞–º–∏–π –Ω–∞–±—ñ—Ä –∫–æ–º–∞–Ω–¥ –∫—ñ–ª—å–∫–∞ —Ä–∞–∑—ñ–≤. –¶–µ –µ–∫–æ–Ω–æ–º–∏—Ç—å –±–ª–æ–∫–∏!</p>
  <div class="bg-gray-100 rounded-lg p-2.5 md:p-3 mb-4 md:mb-5 text-gray-800 text-sm md:text-base space-y-1.5">
    <p class="font-medium">1. –î–æ–¥–∞–π –±–ª–æ–∫ ¬´–¶–∏–∫–ª –ø–æ–≤—Ç–æ—Ä–∏—Ç–∏¬ª –ø–µ—Ä–µ—Ç—è–≥—É–≤–∞–Ω–Ω—è–º –∞–±–æ –∫–ª—ñ–∫–æ–º.</p>
    <p class="font-medium">2. –ü–µ—Ä–µ—Ç—è–≥–Ω–∏ –ø–æ—Ç—Ä—ñ–±–Ω—ñ –∫–æ–º–∞–Ω–¥–∏ —É —Å–≤—ñ—Ç–ª—É –æ–±–ª–∞—Å—Ç—å –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ —Ü–∏–∫–ª—É.</p>
    <p class="font-medium">3. –ó–∞–¥–∞–π –∫—ñ–ª—å–∫—ñ—Å—Ç—å –ø–æ–≤—Ç–æ—Ä–µ–Ω—å —É –ø–æ–ª—ñ —Ç–∞ –∑–∞–ø—É—Å–∫–∞–π –∞–ª–≥–æ—Ä–∏—Ç–º!</p>
  </div>
  <button class="btn-3d w-full font-display text-white rounded-xl p-2.5 md:p-3 text-base md:text-lg bg-green-500 [--shadow-color:theme(colors.green.700)] hover:bg-green-400" id="tutorialCloseBtn">–ó—Ä–æ–∑—É–º—ñ–ª–æ!</button>
</div>

<div id="victoryModalBackdrop" class="fixed inset-0 bg-black/60 z-40 hidden" aria-hidden="true"></div>
<div id="victoryModal" class="fixed top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 bg-white p-4 md:p-8 rounded-2xl shadow-2xl z-50 w-11/12 max-w-lg hidden" role="dialog" aria-modal="true" aria-labelledby="victoryTitle">
  <div class="bg-gradient-to-r from-green-400 to-green-500 text-white p-3 md:p-4 rounded-xl mb-4 md:mb-6 text-center">
    <div class="flex items-center justify-center gap-2 md:gap-3 mb-2">
      <span class="text-2xl md:text-3xl" aria-hidden="true">üéâ</span>
      <h2 id="victoryTitle" class="font-display text-xl md:text-3xl">–ü–µ—Ä–µ–º–æ–≥–∞!</h2>
      <span class="text-2xl md:text-3xl" aria-hidden="true">üèÜ</span>
    </div>
    <div class="text-base md:text-xl font-bold" id="victoryStats">–ë–ª–æ–∫—ñ–≤: <span id="victoryBlockCount">0</span></div>
    <div class="text-sm md:text-base mt-1" id="victoryMedal">ü•á (–ó–æ–ª–æ—Ç–æ!)</div>
  </div>
  <div class="text-center">
    <button class="btn-3d font-display text-gray-800 rounded-xl p-3 md:p-4 text-lg md:text-xl bg-yellow-400 [--shadow-color:theme(colors.yellow.600)] hover:bg-yellow-300 w-full" id="victoryNextBtn">
      <i class="fas fa-forward mr-2" aria-hidden="true"></i>–ù–∞—Å—Ç—É–ø–Ω–∏–π —Ä—ñ–≤–µ–Ω—å
    </button>
  </div>
</div>

<!-- –ü—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –º–æ–¥—É–ª—ñ–≤ JS -->
<script type="module" src="js/main.js"></script>
</body>
</html>
