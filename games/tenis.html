<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>–¢–µ–Ω—ñ—Å - –ì—Ä–∞ –Ω–∞ –¥–≤–æ—Ö</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html, body {
            width: 100%;
            height: 100%;
            overflow: hidden; /* –ó–∞–ø–æ–±—ñ–≥–∞—î–º–æ –ø—Ä–æ–∫—Ä—É—Ç—Ü—ñ –Ω–∞ –º–æ–±—ñ–ª—å–Ω–∏—Ö */
        }

        body {
            display: flex;
            justify-content: center;
            align-items: flex-start;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            font-family: 'Courier New', monospace;
            padding: 1rem;
        }

        .game-container {
            text-align: center;
            padding: 20px;
            max-width: 1000px;
            width: 100%;
        }

        .score-board {
            display: flex;
            justify-content: space-around;
            margin-bottom: 15px;
            color: #f0f0f0;
            font-size: clamp(20px, 4vw, 32px); /* –ê–¥–∞–ø—Ç–∏–≤–Ω–∏–π —Ä–æ–∑–º—ñ—Ä —à—Ä–∏—Ñ—Ç—É */
            text-shadow: 0 0 10px rgba(255, 200, 100, 0.5);
        }

        .player-score {
            padding: 10px 20px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            backdrop-filter: blur(10px);
        }

        canvas {
            border: 3px solid #ffc857;
            border-radius: 10px;
            background: #0a0a1a;
            box-shadow: 0 0 30px rgba(255, 200, 100, 0.3);
            width: 100%; /* –ó–∞–π–º–∞—î –≤—Å—é —à–∏—Ä–∏–Ω—É –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ */
            height: auto;
            aspect-ratio: 800 / 500; /* –ó–±–µ—Ä—ñ–≥–∞—î–º–æ –ø—Ä–æ–ø–æ—Ä—Ü—ñ—ó */
            display: block;
        }

        .controls {
            margin-top: 15px;
            color: #ffc857;
            font-size: clamp(12px, 2.5vw, 14px);
            line-height: 1.6;
        }

        .btn {
            margin-top: 15px;
            padding: 12px 30px;
            font-size: 16px;
            font-family: 'Courier New', monospace;
            background: #ffc857;
            color: #1a1a2e;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: bold;
        }

        .btn:hover {
            background: #ffb020;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(255, 200, 100, 0.4);
        }

        .game-over {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(26, 26, 46, 0.95);
            padding: 40px;
            border-radius: 15px;
            border: 3px solid #ffc857;
            display: none;
            text-align: center;
            box-shadow: 0 0 50px rgba(255, 200, 100, 0.5);
            z-index: 10;
        }

        .game-over h2 {
            color: #ffc857;
            font-size: 36px;
            margin-bottom: 20px;
            text-shadow: 0 0 15px rgba(255, 200, 100, 0.7);
        }

        .game-over p {
            color: #f0f0f0;
            font-size: 20px;
            margin-bottom: 25px;
        }
    </style>
</head>
<body>
    <div class="game-container">
        <div class="score-board">
            <div class="player-score">
                <div>–ì—Ä–∞–≤–µ—Ü—å 1: <span id="score1">0</span></div>
            </div>
            <div class="player-score">
                <div>–ì—Ä–∞–≤–µ—Ü—å 2: <span id="score2">0</span></div>
            </div>
        </div>
        
        <canvas id="gameCanvas"></canvas>
        
        <div class="controls">
            <div>üéÆ –ö–µ—Ä—É–≤–∞–Ω–Ω—è üéÆ</div>
            <div>–ü–ö: –ì—Ä–∞–≤–µ—Ü—å 1 (W/S) | –ì—Ä–∞–≤–µ—Ü—å 2 (‚Üë/‚Üì)</div>
            <div>–ú–æ–±—ñ–ª—å–Ω—ñ: –õ—ñ–≤–∞/–ü—Ä–∞–≤–∞ —á–∞—Å—Ç–∏–Ω–∞ –µ–∫—Ä–∞–Ω–∞</div>
            <button class="btn" onclick="startGame()">–ü–æ—á–∞—Ç–∏ –≥—Ä—É</button>
        </div>
    </div>

    <div class="game-over" id="gameOver">
        <h2>–ì—Ä–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞!</h2>
        <p id="winner"></p>
        <button class="btn" onclick="resetGame()">–ì—Ä–∞—Ç–∏ –∑–Ω–æ–≤—É</button>
    </div>

    <script>
        // –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è canvas
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        
        if (!canvas || !ctx) {
            console.error('Canvas –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ');
        }

        // –û—Ä–∏–≥—ñ–Ω–∞–ª—å–Ω—ñ –ø—Ä–æ–ø–æ—Ä—Ü—ñ—ó –¥–ª—è —Ä–æ–∑—Ä–∞—Ö—É–Ω–∫—ñ–≤
        const BASE_WIDTH = 800;
        const BASE_HEIGHT = 500;
        let scaleFactor = 1;

        // –ö–æ–Ω—Å—Ç–∞–Ω—Ç–∏ –≥—Ä–∏
        const CONSTANTS = {
            PADDLE_WIDTH: 15,
            PADDLE_HEIGHT: 100,
            PADDLE_SPEED: 8, // –ó–±—ñ–ª—å—à–µ–Ω–æ —à–≤–∏–¥–∫—ñ—Å—Ç—å –¥–ª—è –∫—Ä–∞—â–æ–≥–æ –≤—ñ–¥—á—É—Ç—Ç—è
            BALL_RADIUS: 8,
            BALL_INITIAL_SPEED: 6,
            BALL_MAX_SPEED: 15,
            BALL_SPEED_INCREMENT: 1.05,
            WINNING_SCORE: 5,
            NET_SEGMENT_HEIGHT: 10,
            NET_SEGMENT_GAP: 20
        };

        // –°—Ç–∞–Ω –≥—Ä–∏
        let gameState = {
            running: false,
            animationId: null,
            lastCollisionTime: 0,
            pointInProgress: false
        };

        // –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è –æ–±'—î–∫—Ç—ñ–≤ –≥—Ä–∏
        let game = { player1: {}, player2: {}, ball: {} };
        
        function createPlayer(x, y) {
            return { x, y, width: CONSTANTS.PADDLE_WIDTH, height: CONSTANTS.PADDLE_HEIGHT, speed: CONSTANTS.PADDLE_SPEED, score: 0, upKey: false, downKey: false };
        }

        function createBall() {
            return { x: canvas.width / 2, y: canvas.height / 2, radius: CONSTANTS.BALL_RADIUS, speedX: CONSTANTS.BALL_INITIAL_SPEED, speedY: CONSTANTS.BALL_INITIAL_SPEED, maxSpeed: CONSTANTS.BALL_MAX_SPEED };
        }
        
        function initializeGameObjects() {
            game.player1 = createPlayer(20 * scaleFactor, canvas.height / 2 - (CONSTANTS.PADDLE_HEIGHT * scaleFactor) / 2);
            game.player2 = createPlayer(canvas.width - (20 + CONSTANTS.PADDLE_WIDTH) * scaleFactor, canvas.height / 2 - (CONSTANTS.PADDLE_HEIGHT * scaleFactor) / 2);
            game.ball = createBall();
        }

        // --- –ê–î–ê–ü–¢–ò–í–ù–Ü–°–¢–¨ CANVAS ---
        function resizeCanvas() {
            const container = canvas.parentElement;
            const aspectRatio = BASE_WIDTH / BASE_HEIGHT;
            const containerWidth = container.clientWidth;
            
            canvas.width = containerWidth;
            canvas.height = containerWidth / aspectRatio;
            
            scaleFactor = canvas.width / BASE_WIDTH;

            initializeGameObjects();
            updateScore();
            render(); // –ü–µ—Ä–µ–º–∞–ª—é–≤–∞—Ç–∏ –ø—ñ—Å–ª—è –∑–º—ñ–Ω–∏ —Ä–æ–∑–º—ñ—Ä—É
        }
        
        window.addEventListener('resize', resizeCanvas);
        // --- –ö–Ü–ù–ï–¶–¨ –ë–õ–û–ö–£ –ê–î–ê–ü–¢–ò–í–ù–û–°–¢–Ü ---

        // --- –ö–ï–†–£–í–ê–ù–ù–Ø ---
        document.addEventListener('keydown', (e) => {
            if (e.key === 'w' || e.key === 'W' || e.key === '—Ü' || e.key === '–¶') { e.preventDefault(); game.player1.upKey = true; }
            if (e.key === 's' || e.key === 'S' || e.key === '—ñ' || e.key === '–Ü') { e.preventDefault(); game.player1.downKey = true; }
            if (e.key === 'ArrowUp') { e.preventDefault(); game.player2.upKey = true; }
            if (e.key === 'ArrowDown') { e.preventDefault(); game.player2.downKey = true; }
        });

        document.addEventListener('keyup', (e) => {
            if (e.key === 'w' || e.key === 'W' || e.key === '—Ü' || e.key === '–¶') { game.player1.upKey = false; }
            if (e.key === 's' || e.key === 'S' || e.key === '—ñ' || e.key === '–Ü') { game.player1.downKey = false; }
            if (e.key === 'ArrowUp') { game.player2.upKey = false; }
            if (e.key === 'ArrowDown') { game.player2.downKey = false; }
        });

        // --- –ú–û–ë–Ü–õ–¨–ù–ï –ö–ï–†–£–í–ê–ù–ù–Ø ---
        function handleTouch(e) {
            e.preventDefault();
            for (let i = 0; i < e.touches.length; i++) {
                const touch = e.touches[i];
                const rect = canvas.getBoundingClientRect();
                const touchY = touch.clientY - rect.top;

                if (touch.clientX < window.innerWidth / 2) {
                    // –õ—ñ–≤–∞ —á–∞—Å—Ç–∏–Ω–∞ –µ–∫—Ä–∞–Ω–∞ –¥–ª—è –≥—Ä–∞–≤—Ü—è 1
                    game.player1.y = touchY - (game.player1.height * scaleFactor) / 2;
                } else {
                    // –ü—Ä–∞–≤–∞ —á–∞—Å—Ç–∏–Ω–∞ –µ–∫—Ä–∞–Ω–∞ –¥–ª—è –≥—Ä–∞–≤—Ü—è 2
                    game.player2.y = touchY - (game.player2.height * scaleFactor) / 2;
                }
            }
        }
        canvas.addEventListener('touchstart', handleTouch, { passive: false });
        canvas.addEventListener('touchmove', handleTouch, { passive: false });
        // --- –ö–Ü–ù–ï–¶–¨ –ë–õ–û–ö–£ –ú–û–ë–Ü–õ–¨–ù–û–ì–û –ö–ï–†–£–í–ê–ù–ù–Ø ---

        // –§—É–Ω–∫—Ü—ñ—ó –º–∞–ª—é–≤–∞–Ω–Ω—è
        function drawRect(x, y, w, h, color) {
            if (!ctx) return;
            ctx.save();
            ctx.fillStyle = color;
            ctx.shadowBlur = 15 * scaleFactor;
            ctx.shadowColor = color;
            ctx.fillRect(x, y, w * scaleFactor, h * scaleFactor);
            ctx.restore();
        }

        function drawCircle(x, y, r, color) {
            if (!ctx) return;
            ctx.save();
            ctx.fillStyle = color;
            ctx.shadowBlur = 20 * scaleFactor;
            ctx.shadowColor = color;
            ctx.beginPath();
            ctx.arc(x, y, r * scaleFactor, 0, Math.PI * 2);
            ctx.fill();
            ctx.restore();
        }

        function drawNet() {
            const centerX = canvas.width / 2 - (2 * scaleFactor);
            for (let i = 0; i < canvas.height; i += CONSTANTS.NET_SEGMENT_GAP * scaleFactor) {
                drawRect(centerX / scaleFactor, i / scaleFactor, 4, CONSTANTS.NET_SEGMENT_HEIGHT, 'rgba(255, 200, 100, 0.3)');
            }
        }

        // –õ–æ–≥—ñ–∫–∞ —Ä—É—Ö—É
        function movePaddle(player) {
            const scaledPaddleHeight = player.height * scaleFactor;
            const scaledSpeed = player.speed * scaleFactor;

            if (player.upKey && player.y > 0) {
                player.y = Math.max(0, player.y - scaledSpeed);
            }
            if (player.downKey && player.y < canvas.height - scaledPaddleHeight) {
                player.y = Math.min(canvas.height - scaledPaddleHeight, player.y + scaledSpeed);
            }
             // –û–±–º–µ–∂–µ–Ω–Ω—è –≤–∏—Ö–æ–¥—É –∑–∞ –º–µ–∂—ñ –ø–æ–ª—è –¥–ª—è —Ç–∞—á-–∫–µ—Ä—É–≤–∞–Ω–Ω—è
            player.y = Math.max(0, Math.min(player.y, canvas.height - scaledPaddleHeight));
        }

        function movePaddles() {
            movePaddle(game.player1);
            movePaddle(game.player2);
        }
        
        function checkCollision(ball, player) {
            const scaledRadius = ball.radius * scaleFactor;
            const scaledPlayerWidth = player.width * scaleFactor;
            const scaledPlayerHeight = player.height * scaleFactor;

            return ball.x - scaledRadius < player.x + scaledPlayerWidth &&
                   ball.x + scaledRadius > player.x &&
                   ball.y - scaledRadius < player.y + scaledPlayerHeight &&
                   ball.y + scaledRadius > player.y;
        }


        function handleBallPaddleCollision(player) {
            const now = Date.now();
            if (now - gameState.lastCollisionTime < 100) return;
            gameState.lastCollisionTime = now;
            
            const scaledPlayerHeight = player.height * scaleFactor;
            const collidePoint = (game.ball.y - (player.y + scaledPlayerHeight / 2)) / (scaledPlayerHeight / 2);
            const angleRad = Math.max(-Math.PI / 3, Math.min(Math.PI / 3, collidePoint * Math.PI / 4));
            
            const direction = (game.ball.x < canvas.width / 2) ? 1 : -1;
            
            let newSpeedX = Math.abs(game.ball.speedX) * CONSTANTS.BALL_SPEED_INCREMENT;
            game.ball.speedX = direction * Math.min(newSpeedX, game.ball.maxSpeed * scaleFactor);
            game.ball.speedY = Math.abs(newSpeedX) * Math.sin(angleRad);
            
            const scaledRadius = game.ball.radius * scaleFactor;
            if (direction > 0) {
                game.ball.x = player.x + player.width * scaleFactor + scaledRadius;
            } else {
                game.ball.x = player.x - scaledRadius;
            }
        }


        function moveBall() {
            if (gameState.pointInProgress) return;

            game.ball.x += game.ball.speedX;
            game.ball.y += game.ball.speedY;
            
            const scaledRadius = game.ball.radius * scaleFactor;

            if (game.ball.y + scaledRadius >= canvas.height) {
                game.ball.y = canvas.height - scaledRadius;
                game.ball.speedY *= -1;
            } else if (game.ball.y - scaledRadius <= 0) {
                game.ball.y = scaledRadius;
                game.ball.speedY *= -1;
            }

            const player = game.ball.x < canvas.width / 2 ? game.player1 : game.player2;
            if (checkCollision(game.ball, player)) {
                handleBallPaddleCollision(player);
            }

            if (game.ball.x + scaledRadius < 0) {
                game.player2.score++;
                updateScore();
                gameState.pointInProgress = true;
                checkWinner();
            } else if (game.ball.x - scaledRadius > canvas.width) {
                game.player1.score++;
                updateScore();
                gameState.pointInProgress = true;
                checkWinner();
            }
        }

        function checkWinner() {
            if (game.player1.score >= CONSTANTS.WINNING_SCORE || game.player2.score >= CONSTANTS.WINNING_SCORE) {
                endGame();
            } else {
                setTimeout(() => {
                    if (gameState.running) {
                        resetBall();
                        gameState.pointInProgress = false;
                    }
                }, 1000);
            }
        }

        function resetBall() {
            game.ball.x = canvas.width / 2;
            game.ball.y = canvas.height / 2;
            const scaledInitialSpeed = CONSTANTS.BALL_INITIAL_SPEED * scaleFactor;
            game.ball.speedX = (Math.random() > 0.5 ? 1 : -1) * scaledInitialSpeed;
            game.ball.speedY = (Math.random() * 2 - 1) * scaledInitialSpeed * 0.5;
            gameState.lastCollisionTime = 0;
        }

        function updateScore() {
            document.getElementById('score1').textContent = game.player1.score;
            document.getElementById('score2').textContent = game.player2.score;
        }

        function render() {
            if (!ctx) return;
            ctx.fillStyle = 'rgba(10, 10, 26, 0.9)';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            
            drawNet();
            drawRect(game.player1.x / scaleFactor, game.player1.y / scaleFactor, game.player1.width, game.player1.height, '#ffc857');
            drawRect(game.player2.x / scaleFactor, game.player2.y / scaleFactor, game.player2.width, game.player2.height, '#ffc857');
            drawCircle(game.ball.x, game.ball.y, game.ball.radius, '#ff6b6b');
        }

        function gameLoop() {
            if (!gameState.running) return;
            movePaddles();
            moveBall();
            render();
            gameState.animationId = requestAnimationFrame(gameLoop);
        }

        function startGame() {
            const startButton = document.querySelector('.btn');
            if(startButton) startButton.style.display = 'none';

            if (gameState.running) return;
            gameState.running = true;
            resetBall();
            gameLoop();
        }

        function endGame() {
            gameState.running = false;
            if (gameState.animationId) {
                cancelAnimationFrame(gameState.animationId);
                gameState.animationId = null;
            }
            const winner = game.player1.score >= CONSTANTS.WINNING_SCORE ? '–ì—Ä–∞–≤–µ—Ü—å 1' : '–ì—Ä–∞–≤–µ—Ü—å 2';
            document.getElementById('winner').textContent = `${winner} –ø–µ—Ä–µ–º—ñ–≥! üèÜ`;
            document.getElementById('gameOver').style.display = 'block';
        }

        function resetGame() {
            document.getElementById('gameOver').style.display = 'none';
            gameState.pointInProgress = false;
            
            initializeGameObjects();
            updateScore();
            
            startGame();
        }

        // –ü–µ—Ä—à–∏–π –∑–∞–ø—É—Å–∫
        resizeCanvas();
    </script>
</body>
</html>

