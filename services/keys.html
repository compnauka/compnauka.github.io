<!DOCTYPE html>
<html lang="uk">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>–¢—Ä–µ–Ω–∞–∂–µ—Ä –∫–ª–∞–≤—ñ–∞—Ç—É—Ä–∏ –¥–ª—è –¥—ñ—Ç–µ–π</title>
        <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-N8T05K3NGT"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      const gtag = (...args) => dataLayer.push(args);
      gtag("js", new Date());
      gtag("config", "G-N8T05K3NGT");
    </script>
    <style>
      body {
        font-family: "Roboto", "Arial", sans-serif;
        background-color: #f2f9fe;
        margin: 0;
        padding: 20px;
        display: flex;
        flex-direction: column;
        align-items: center;
        min-height: 100vh;
        box-sizing: border-box;
      }

      h1 {
        color: #4285f4;
        text-align: center;
        margin-bottom: 20px;
        font-size: 2.2em;
        text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
      }

      #game-container {
        width: 100%;
        max-width: 800px;
        display: flex;
        flex-direction: column;
        align-items: center;
        background-color: white;
        border-radius: 20px;
        box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
        padding: 20px;
      }

      #info-panel {
        display: flex;
        justify-content: space-between;
        width: 100%;
        margin-bottom: 20px;
      }

      #score,
      #timer {
        font-size: 1.5em;
        font-weight: bold;
        color: #333;
        background-color: #ffeb3b;
        padding: 10px 20px;
        border-radius: 10px;
        min-width: 120px;
        text-align: center;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
      }

      #game-field {
        width: 100%;
        height: 300px;
        background-color: #e6f7ff;
        border: 4px solid #4285f4;
        border-radius: 15px;
        position: relative;
        overflow: hidden;
        margin-bottom: 20px;
        box-shadow: inset 0 0 10px rgba(0, 0, 0, 0.1);
      }

      #levels,
      #speed-control {
        display: flex;
        justify-content: center;
        gap: 15px;
        width: 100%;
        margin-bottom: 20px;
      }

      button {
        background-color: #4285f4;
        color: white;
        border: none;
        padding: 10px 20px;
        font-size: 1.2em;
        border-radius: 10px;
        cursor: pointer;
        transition: all 0.3s;
        font-family: "Comic Sans MS", cursive, sans-serif;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
      }

      button:hover {
        background-color: #3367d6;
        transform: translateY(-2px);
      }

      button:active {
        transform: translateY(1px);
      }

      button.selected {
        background-color: #34a853;
      }

      button.start-again {
        background-color: #fbbc05;
        display: none;
        margin: 0 auto;
      }

      .letter {
        position: absolute;
        font-size: 2em;
        font-weight: bold;
        color: #333;
        display: flex;
        align-items: center;
        justify-content: center;
        width: 50px;
        height: 50px;
        border-radius: 50%;
        background-color: white;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        animation-timing-function: linear;
        animation-fill-mode: forwards;
      }

      .letter.correct {
        background-color: #34a853;
        color: white;
      }

      .letter.missed {
        background-color: #ea4335;
        color: white;
      }

      #game-over {
        display: none;
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(255, 255, 255, 0.9);
        flex-direction: column;
        align-items: center;
        justify-content: center;
        z-index: 10;
        border-radius: 15px;
      }

      #game-over h2 {
        color: #4285f4;
        font-size: 2em;
        margin-bottom: 10px;
      }

      #final-score,
      #final-level,
      #final-speed {
        font-size: 1.4em;
        color: #34a853;
        margin-bottom: 10px;
      }

      #instructions {
        background-color: #f8f9fa;
        border-radius: 10px;
        padding: 15px;
        margin-top: 20px;
        max-width: 800px;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
      }

      #instructions h3 {
        color: #4285f4;
        margin-top: 0;
      }

      #instructions p {
        color: #333;
        line-height: 1.5;
      }

      .shift-example {
        background-color: #e6f7ff;
        border-radius: 8px;
        padding: 10px;
        margin: 10px 0;
      }

      @keyframes moveRight {
        from {
          left: 0;
        }
        to {
          left: calc(100% - 50px);
        }
      }
    </style>
  </head>
  <body>
    <h1>–ö–ª–∞–≤—ñ–∞—Ç—É—Ä–Ω–∏–π —Ç—Ä–µ–Ω–∞–∂–µ—Ä</h1>
    <div id="game-container">
      <div id="info-panel">
        <div id="score">–ë–∞–ª–∏: 0</div>
        <div id="timer">–ß–∞—Å: 60</div>
      </div>
      <div id="game-field">
        <div id="game-over">
          <h2>–ß–∞—Å –≤–∏–π—à–æ–≤!</h2>
          <div id="final-score">–í–∞—à —Ä–µ–∑—É–ª—å—Ç–∞—Ç: 0 –±–∞–ª—ñ–≤</div>
          <div id="final-level">–†—ñ–≤–µ–Ω—å —Å–∫–ª–∞–¥–Ω–æ—Å—Ç—ñ: –ü—Ä–æ—Å—Ç–∏–π</div>
          <div id="final-speed">–®–≤–∏–¥–∫—ñ—Å—Ç—å: –°–µ—Ä–µ–¥–Ω—è</div>
        </div>
      </div>
      <div id="levels">
        <button id="easy" class="selected" onclick="selectLevel('easy')">
          –ü—Ä–æ—Å—Ç–∏–π
        </button>
        <button id="medium" onclick="selectLevel('medium')">–°–µ—Ä–µ–¥–Ω—ñ–π</button>
        <button id="hard" onclick="selectLevel('hard')">–°–∫–ª–∞–¥–Ω–∏–π</button>
      </div>
      <div id="speed-control">
        <button id="slow" onclick="selectSpeed('slow')">–ü–æ–≤—ñ–ª—å–Ω–æ</button>
        <button
          id="medium-speed"
          class="selected"
          onclick="selectSpeed('medium')"
        >
          –°–µ—Ä–µ–¥–Ω—å–æ
        </button>
        <button id="fast" onclick="selectSpeed('fast')">–®–≤–∏–¥–∫–æ</button>
      </div>
      <button id="start-button" onclick="startGame()">–ü–æ—á–∞—Ç–∏ –≥—Ä—É</button>
      <button id="restart-button" class="start-again" onclick="resetGame()">
        –ó—É–ø–∏–Ω–∏—Ç–∏ –≥—Ä—É
      </button>
    </div>
    <div id="instructions">
      <h3>–Ø–∫ –≥—Ä–∞—Ç–∏:</h3>
      <p>
        1. –û–±–µ—Ä–∏ —Ä—ñ–≤–µ–Ω—å —Å–∫–ª–∞–¥–Ω–æ—Å—Ç—ñ —Ç–∞ —à–≤–∏–¥–∫—ñ—Å—Ç—å, –ø–æ—Ç—ñ–º –Ω–∞—Ç–∏—Å–Ω–∏ "–ü–æ—á–∞—Ç–∏ –≥—Ä—É".
      </p>
      <p>2. –õ—ñ—Ç–µ—Ä–∏ –±—É–¥—É—Ç—å –∑'—è–≤–ª—è—Ç–∏—Å—è –∑–ª—ñ–≤–∞ —ñ —Ä—É—Ö–∞—Ç–∏—Å—è –≤–ø—Ä–∞–≤–æ.</p>
      <p>
        3. –ù–∞—Ç–∏—Å–Ω–∏ –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω—É –∫–ª–∞–≤—ñ—à—É –Ω–∞ –∫–ª–∞–≤—ñ–∞—Ç—É—Ä—ñ –¥–æ —Ç–æ–≥–æ, —è–∫ –ª—ñ—Ç–µ—Ä–∞ –∑–Ω–∏–∫–Ω–µ –∑–∞
        –ø—Ä–∞–≤–∏–º –∫—Ä–∞—î–º.
      </p>
      <p>4. –ó–∞ –∫–æ–∂–Ω–µ –ø—Ä–∞–≤–∏–ª—å–Ω–µ –Ω–∞—Ç–∏—Å–∫–∞–Ω–Ω—è —Ç–∏ –æ—Ç—Ä–∏–º—É—î—à 1 –±–∞–ª.</p>
      <p>5. –£ —Ç–µ–±–µ —î 1 —Ö–≤–∏–ª–∏–Ω–∞ (60 —Å–µ–∫—É–Ω–¥) –¥–ª—è –∫–æ–∂–Ω–æ—ó –≥—Ä–∏.</p>
      <p>
        <strong>–†—ñ–≤–Ω—ñ —Å–∫–ª–∞–¥–Ω–æ—Å—Ç—ñ:</strong> <br />‚Ä¢ –ü—Ä–æ—Å—Ç–∏–π: —Ç—ñ–ª—å–∫–∏ –º–∞–ª—ñ –ª—ñ—Ç–µ—Ä–∏
        (–ø—Ä–æ—Å—Ç–æ –Ω–∞—Ç–∏—Å–∫–∞–π –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω—É –∫–ª–∞–≤—ñ—à—É) <br />‚Ä¢ –°–µ—Ä–µ–¥–Ω—ñ–π: –º–∞–ª—ñ —Ç–∞ –≤–µ–ª–∏–∫—ñ
        –ª—ñ—Ç–µ—Ä–∏ (–¥–ª—è –≤–µ–ª–∏–∫–∏—Ö –ª—ñ—Ç–µ—Ä –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ Shift) <br />‚Ä¢ –°–∫–ª–∞–¥–Ω–∏–π:
        –ª—ñ—Ç–µ—Ä–∏, —Ü–∏—Ñ—Ä–∏ —Ç–∞ —Å–ø–µ—Ü—ñ–∞–ª—å–Ω—ñ —Å–∏–º–≤–æ–ª–∏ (–¥–µ—è–∫—ñ —Å–∏–º–≤–æ–ª–∏ –≤–∏–º–∞–≥–∞—é—Ç—å Shift)
      </p>
      <div class="shift-example">
        <strong>–Ø–∫ –≤–≤–æ–¥–∏—Ç–∏ –≤–µ–ª–∏–∫—ñ –ª—ñ—Ç–µ—Ä–∏ —Ç–∞ —Å–ø–µ—Ü—ñ–∞–ª—å–Ω—ñ —Å–∏–º–≤–æ–ª–∏:</strong>
        <br />‚Ä¢ –î–ª—è –≤–µ–ª–∏–∫–æ—ó –ª—ñ—Ç–µ—Ä–∏: –Ω–∞—Ç–∏—Å–Ω–∏ Shift + –ª—ñ—Ç–µ—Ä–∞ (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, Shift + –∞
        = –ê) <br />‚Ä¢ –î–ª—è —Å–ø–µ—Ü—ñ–∞–ª—å–Ω–∏—Ö —Å–∏–º–≤–æ–ª—ñ–≤: –Ω–∞—Ç–∏—Å–Ω–∏ Shift + —Ü–∏—Ñ—Ä–∞/—Å–∏–º–≤–æ–ª
        (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, Shift + 1 = !)
      </div>
      <p>
        <strong>–®–≤–∏–¥–∫—ñ—Å—Ç—å:</strong> <br />‚Ä¢ –ü–æ–≤—ñ–ª—å–Ω–æ: –ª—ñ—Ç–µ—Ä–∏ —Ä—É—Ö–∞—é—Ç—å—Å—è –ø–æ–≤—ñ–ª—å–Ω–æ
        <br />‚Ä¢ –°–µ—Ä–µ–¥–Ω—å–æ: –ª—ñ—Ç–µ—Ä–∏ —Ä—É—Ö–∞—é—Ç—å—Å—è –∑ —Å–µ—Ä–µ–¥–Ω—å–æ—é —à–≤–∏–¥–∫—ñ—Å—Ç—é <br />‚Ä¢ –®–≤–∏–¥–∫–æ:
        –ª—ñ—Ç–µ—Ä–∏ —Ä—É—Ö–∞—é—Ç—å—Å—è —à–≤–∏–¥–∫–æ
      </p>
      <div class="shift-example">
        <strong
          >–ü–ï–†–ï–î –ü–û–ß–ê–¢–ö–û–ú –†–û–ë–û–¢–ò <br />–ù–ï –ó–ê–ë–£–î–¨ –û–ë–†–ê–¢–ò –£–ö–†–ê–á–ù–°–¨–ö–£ –ú–û–í–£ –ù–ê
          –ö–û–ú–ü'–Æ–¢–ï–†–Ü üíõüíô</strong
        >
      </div>
    </div>

    <script>
      // –û–±'—î–∫—Ç —Å—Ç–∞–Ω—É –≥—Ä–∏
      const gameState = {
        score: 0, // –ü–æ—Ç–æ—á–Ω–∏–π —Ä–∞—Ö—É–Ω–æ–∫
        timer: 60, // –ß–∞—Å –≥—Ä–∏ –≤ —Å–µ–∫—É–Ω–¥–∞—Ö
        selectedLevel: "easy", // –û–±—Ä–∞–Ω–∏–π —Ä—ñ–≤–µ–Ω—å —Å–∫–ª–∞–¥–Ω–æ—Å—Ç—ñ
        selectedSpeed: "medium", // –û–±—Ä–∞–Ω–∞ —à–≤–∏–¥–∫—ñ—Å—Ç—å
        isGameRunning: false, // –ß–∏ –∑–∞–ø—É—â–µ–Ω–∞ –≥—Ä–∞
        isPaused: false, // –ß–∏ –Ω–∞ –ø–∞—É–∑—ñ
        animationSpeed: 6000, // –®–≤–∏–¥–∫—ñ—Å—Ç—å –∞–Ω—ñ–º–∞—Ü—ñ—ó (–º—Å)
        spawnInterval: 1500, // –Ü–Ω—Ç–µ—Ä–≤–∞–ª –ø–æ—è–≤–∏ –Ω–æ–≤–∏—Ö —Å–∏–º–≤–æ–ª—ñ–≤ (–º—Å)
        activeLetters: new Map(), // –ú–∞–ø–∞ –∞–∫—Ç–∏–≤–Ω–∏—Ö —Å–∏–º–≤–æ–ª—ñ–≤
        timerInterval: null, // –Ü–Ω—Ç–µ—Ä–≤–∞–ª —Ç–∞–π–º–µ—Ä–∞
        spawnTimeout: null, // –¢–∞–π–º–∞—É—Ç –¥–ª—è —Å–ø–∞–≤–Ω—É
      };

      // –ù–∞–±–æ—Ä–∏ —Å–∏–º–≤–æ–ª—ñ–≤ –¥–ª—è —Ä—ñ–∑–Ω–∏—Ö —Ä—ñ–≤–Ω—ñ–≤ —Å–∫–ª–∞–¥–Ω–æ—Å—Ç—ñ
      const basicLevels = {
        easy: "–∞–±–≤–≥–¥–µ—î–∂–∑–∏—ñ—ó–π–∫–ª–º–Ω–æ–ø—Ä—Å—Ç—É—Ñ—Ö—Ü—á—à—â—å—é—è",
        medium:
          "–∞–±–≤–≥–¥–µ—î–∂–∑–∏—ñ—ó–π–∫–ª–º–Ω–æ–ø—Ä—Å—Ç—É—Ñ—Ö—Ü—á—à—â—å—é—è–ê–ë–í–ì–î–ï–Ñ–ñ–ó–ò–Ü–á–ô–ö–õ–ú–ù–û–ü–†–°–¢–£–§–•–¶–ß–®–©–¨–Æ–Ø",
        hard: '–∞–±–≤–≥–¥–µ—î–∂–∑–∏—ñ—ó–π–∫–ª–º–Ω–æ–ø—Ä—Å—Ç—É—Ñ—Ö—Ü—á—à—â—å—é—è–ê–ë–í–ì–î–ï–Ñ–ñ–ó–ò–Ü–á–ô–ö–õ–ú–ù–û–ü–†–°–¢–£–§–•–¶–ß–®–©–¨–Æ–Ø0123456789!"‚Ññ;%:?*()-_=+',
      };

      // –†—ñ–¥–∫—ñ—Å–Ω—ñ —Å–∏–º–≤–æ–ª–∏ –¥–ª—è —Ä—ñ–≤–Ω—ñ–≤
      const rareChars = {
        easy: "“ë",
        medium: "“ë“ê",
        hard: "“ë“ê",
      };

      // –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è —à–≤–∏–¥–∫–æ—Å—Ç—ñ –≥—Ä–∏
      const speedSettings = {
        slow: { animationSpeed: 8000, spawnInterval: 2000 },
        medium: { animationSpeed: 6000, spawnInterval: 1500 },
        fast: { animationSpeed: 4000, spawnInterval: 1000 },
      };

      // –ú–∞–ø–∞ –¥–ª—è –∑—ñ—Å—Ç–∞–≤–ª–µ–Ω–Ω—è —Å–∏–º–≤–æ–ª—ñ–≤ —ñ–∑ –∫–ª–∞–≤—ñ—à–∞–º–∏
      const keyMap = new Map();

      // –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è –º–∞–ø–∏ –∫–ª–∞–≤—ñ—à
      function initializeKeyMap() {
        const smallLetters = "–∞–±–≤–≥–¥–µ—î–∂–∑–∏—ñ—ó–π–∫–ª–º–Ω–æ–ø—Ä—Å—Ç—É—Ñ—Ö—Ü—á—à—â—å—é—è“ë";
        const capitalLetters = "–ê–ë–í–ì–î–ï–Ñ–ñ–ó–ò–Ü–á–ô–ö–õ–ú–ù–û–ü–†–°–¢–£–§–•–¶–ß–®–©–¨–Æ–Ø“ê";

        // –î–æ–¥–∞–≤–∞–Ω–Ω—è –º–∞–ª–∏—Ö —ñ –≤–µ–ª–∏–∫–∏—Ö –ª—ñ—Ç–µ—Ä
        for (let i = 0; i < smallLetters.length; i++) {
          keyMap.set(smallLetters[i], { key: smallLetters[i], shift: false });
          keyMap.set(capitalLetters[i], { key: smallLetters[i], shift: true });
        }

        // –î–æ–¥–∞–≤–∞–Ω–Ω—è —Ü–∏—Ñ—Ä
        for (let i = 0; i <= 9; i++) {
          keyMap.set(i.toString(), { key: i.toString(), shift: false });
        }

        // –î–æ–¥–∞–≤–∞–Ω–Ω—è —Å–ø–µ—Ü—ñ–∞–ª—å–Ω–∏—Ö —Å–∏–º–≤–æ–ª—ñ–≤ —ñ–∑ Shift
        const specialChars = {
          "!": "1",
          '"': "2",
          "‚Ññ": "3",
          ";": "4",
          "%": "5",
          ":": "6",
          "?": "7",
          "*": "8",
          "(": "9",
          ")": "0",
          _: "-",
          "+": "=",
        };
        for (const [char, key] of Object.entries(specialChars)) {
          keyMap.set(char, { key, shift: true });
        }

        // –î–æ–¥–∞–≤–∞–Ω–Ω—è —Å–∏–º–≤–æ–ª—ñ–≤ –±–µ–∑ Shift
        keyMap.set("-", { key: "-", shift: false });
        keyMap.set("=", { key: "=", shift: false });
      }

      // –í–∏–±—ñ—Ä —Ä—ñ–≤–Ω—è –∞–±–æ —à–≤–∏–¥–∫–æ—Å—Ç—ñ
      function selectOption(type, value) {
        if (type === "level") {
          gameState.selectedLevel = value;
          document
            .querySelectorAll("#levels button")
            .forEach((btn) => btn.classList.remove("selected"));
          document.getElementById(value).classList.add("selected");
        } else if (type === "speed") {
          gameState.selectedSpeed = value;
          document
            .querySelectorAll("#speed-control button")
            .forEach((btn) => btn.classList.remove("selected"));
          document
            .getElementById(value === "medium" ? "medium-speed" : value)
            .classList.add("selected");
        }
        updateGameSpeed();
      }

      // –û–Ω–æ–≤–ª–µ–Ω–Ω—è —à–≤–∏–¥–∫–æ—Å—Ç—ñ –≥—Ä–∏ –∑–∞–ª–µ–∂–Ω–æ –≤—ñ–¥ —Ä—ñ–≤–Ω—è —Ç–∞ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω—å
      function updateGameSpeed() {
        const base = speedSettings[gameState.selectedSpeed];
        const modifier = { easy: 1, medium: 0.9, hard: 0.8 }[
          gameState.selectedLevel
        ];
        gameState.animationSpeed = base.animationSpeed * modifier;
        gameState.spawnInterval = base.spawnInterval * modifier;
      }

      // –í–∏–±—ñ—Ä –≤–∏–ø–∞–¥–∫–æ–≤–æ–≥–æ —Å–∏–º–≤–æ–ª—É
      function getRandomChar() {
        return Math.random() < 0.02
          ? rareChars[gameState.selectedLevel][
              Math.floor(
                Math.random() * rareChars[gameState.selectedLevel].length
              )
            ]
          : basicLevels[gameState.selectedLevel][
              Math.floor(
                Math.random() * basicLevels[gameState.selectedLevel].length
              )
            ];
      }

      // –ü–æ—á–∞—Ç–æ–∫ –≥—Ä–∏
      function startGame() {
        if (gameState.isGameRunning) return;
        resetGameState();
        document.getElementById("game-over").style.display = "none";
        document.getElementById("start-button").style.display = "none";
        document.getElementById("restart-button").style.display = "block";
        gameState.isGameRunning = true;
        gameState.timerInterval = setInterval(updateTimer, 1000);
        spawnLetter();
        document.addEventListener("keydown", handleKeyPress);
      }

      // –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ –≥—Ä–∏
      function resetGame() {
        if (gameState.isGameRunning) clearAllIntervals();
        document
          .getElementById("game-field")
          .querySelectorAll(".letter")
          .forEach((letter) => letter.remove());
        document.getElementById("game-over").style.display = "none";
        document.getElementById("start-button").style.display = "block";
        document.getElementById("restart-button").style.display = "none";
        resetGameState();
        updateScore();
        updateTimer();
        gameState.isGameRunning = false;
      }

      // –°–∫–∏–¥–∞–Ω–Ω—è —Å—Ç–∞–Ω—É –≥—Ä–∏
      function resetGameState() {
        gameState.score = 0;
        gameState.timer = 60;
        gameState.activeLetters.clear();
      }

      // –û–Ω–æ–≤–ª–µ–Ω–Ω—è —Ä–∞—Ö—É–Ω–∫—É –Ω–∞ –µ–∫—Ä–∞–Ω—ñ
      function updateScore() {
        document.getElementById(
          "score"
        ).textContent = `–ë–∞–ª–∏: ${gameState.score}`;
      }

      // –û–Ω–æ–≤–ª–µ–Ω–Ω—è —Ç–∞–π–º–µ—Ä–∞
      function updateTimer() {
        gameState.timer--;
        document.getElementById(
          "timer"
        ).textContent = `–ß–∞—Å: ${gameState.timer}`;
        if (gameState.timer <= 0) endGame();
      }

      // –ó–∞–≤–µ—Ä—à–µ–Ω–Ω—è –≥—Ä–∏
      function endGame() {
        gameState.isGameRunning = false;
        clearAllIntervals();
        document.removeEventListener("keydown", handleKeyPress);
        document.getElementById(
          "final-score"
        ).textContent = `–í–∞—à —Ä–µ–∑—É–ª—å—Ç–∞—Ç: ${gameState.score} –±–∞–ª—ñ–≤`;
        document.getElementById(
          "final-level"
        ).textContent = `–†—ñ–≤–µ–Ω—å —Å–∫–ª–∞–¥–Ω–æ—Å—Ç—ñ: ${
          {
            easy: "–ü—Ä–æ—Å—Ç–∏–π",
            medium: "–°–µ—Ä–µ–¥–Ω—ñ–π",
            hard: "–°–∫–ª–∞–¥–Ω–∏–π",
          }[gameState.selectedLevel]
        }`;
        document.getElementById("final-speed").textContent = `–®–≤–∏–¥–∫—ñ—Å—Ç—å: ${
          {
            slow: "–ü–æ–≤—ñ–ª—å–Ω–∞",
            medium: "–°–µ—Ä–µ–¥–Ω—è",
            fast: "–®–≤–∏–¥–∫–∞",
          }[gameState.selectedSpeed]
        }`;
        document.getElementById("game-over").style.display = "flex";
        document.getElementById("start-button").style.display = "none";
      }

      // –û—á–∏—â–µ–Ω–Ω—è –≤—Å—ñ—Ö —ñ–Ω—Ç–µ—Ä–≤–∞–ª—ñ–≤ —ñ —Ç–∞–π–º–∞—É—Ç—ñ–≤
      function clearAllIntervals() {
        clearInterval(gameState.timerInterval);
        clearTimeout(gameState.spawnTimeout);
        gameState.activeLetters.forEach((letter) =>
          clearTimeout(letter.timeout)
        );
      }

      // –°—Ç–≤–æ—Ä–µ–Ω–Ω—è –Ω–æ–≤–æ–≥–æ —Å–∏–º–≤–æ–ª—É –Ω–∞ –ø–æ–ª—ñ
      function spawnLetter() {
        if (!gameState.isGameRunning) return;
        const gameField = document.getElementById("game-field");
        const letterElement = document.createElement("div");
        const char = getRandomChar();
        const letterId = `letter-${Date.now()}`;
        letterElement.className = "letter";
        letterElement.textContent = char;
        letterElement.id = letterId;
        letterElement.style.top = `${Math.floor(
          Math.random() * (gameField.offsetHeight - 50)
        )}px`;
        letterElement.style.animation = `moveRight ${gameState.animationSpeed}ms linear forwards`;
        gameField.appendChild(letterElement);

        const timeout = setTimeout(() => {
          if (
            gameState.isGameRunning &&
            gameState.activeLetters.has(letterId)
          ) {
            letterElement.classList.add("missed");
            setTimeout(() => {
              if (letterElement.parentNode) letterElement.remove();
              gameState.activeLetters.delete(letterId);
            }, 300);
          }
        }, gameState.animationSpeed);

        gameState.activeLetters.set(letterId, {
          char,
          element: letterElement,
          timeout,
        });
        gameState.spawnTimeout = setTimeout(
          spawnLetter,
          gameState.spawnInterval
        );
      }

      // –û–±—Ä–æ–±–∫–∞ –Ω–∞—Ç–∏—Å–∫–∞–Ω–Ω—è –∫–ª–∞–≤—ñ—à
      function handleKeyPress(e) {
        if (!gameState.isGameRunning || gameState.isPaused) return;

        let matched = false;
        gameState.activeLetters.forEach((letterInfo, id) => {
          if (matched) return;

          const char = letterInfo.char;
          const mapping = keyMap.get(char);
          if (mapping && e.key === char && e.shiftKey === mapping.shift) {
            matched = true;
            gameState.score++;
            updateScore();
            letterInfo.element.classList.add("correct");
            clearTimeout(letterInfo.timeout);
            setTimeout(() => {
              if (letterInfo.element.parentNode) letterInfo.element.remove();
              gameState.activeLetters.delete(id);
            }, 200);
          }
        });
      }

      // –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è –ø—Ä–∏ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—ñ —Å—Ç–æ—Ä—ñ–Ω–∫–∏
      window.onload = () => {
        initializeKeyMap();
        selectOption("level", "easy");
        selectOption("speed", "medium");
        document.querySelectorAll("#levels button").forEach((btn) => {
          btn.addEventListener("click", () => selectOption("level", btn.id));
        });
        document.querySelectorAll("#speed-control button").forEach((btn) => {
          btn.addEventListener("click", () =>
            selectOption("speed", btn.id === "medium-speed" ? "medium" : btn.id)
          );
        });
        document
          .getElementById("start-button")
          .addEventListener("click", startGame);
        document
          .getElementById("restart-button")
          .addEventListener("click", resetGame);
      };
    </script>
  </body>
</html>
