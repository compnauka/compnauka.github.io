<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Інформатика: Тести для початкової школи</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;700;900&display=swap" rel="stylesheet">
    
    <style>
        body { font-family: 'Nunito', sans-serif; }
        .fade-in { animation: fadeIn 0.3s ease-in-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        
        .hover-scale { transition: transform 0.2s; }
        .hover-scale:active { transform: scale(0.95); }

        /* Сховати скролбар, але залишити скрол */
        .hide-scrollbar::-webkit-scrollbar { display: none; }
        .hide-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }

        /* --- ЕЛЕМЕНТИ ДЛЯ ПРИНТУ --- */
        @media screen {
            .print-only { display: none; }
        }

        @media print {
            body {
                background: #ffffff !important;
                color: #000000 !important;
            }
            header,
            footer,
            #modal-overlay {
                display: none !important;
            }
            .no-print {
                display: none !important;
            }
            #app {
                max-width: 100% !important;
                padding: 0 !important;
                margin: 0 !important;
            }
        }
    </style>
</head>
<body class="bg-slate-100 min-h-screen flex flex-col items-center text-slate-800 selection:bg-blue-200">

    <!-- Header -->
    <header class="w-full bg-white shadow-sm p-4 fixed top-0 left-0 z-20 flex justify-between items-center h-16">
        <div class="flex items-center gap-2 text-indigo-600 cursor-pointer hover:opacity-80 transition-opacity" onclick="app.goHome()">
            <i class="fa-solid fa-graduation-cap text-2xl"></i>
            <h1 class="font-bold text-xl hidden sm:block">Інфо-Кібер-Кідс</h1>
        </div>
        <div id="header-status" class="font-bold text-slate-500 text-sm sm:text-base truncate max-w-[200px] sm:max-w-none">
            <!-- Статус оновлюється через JS -->
        </div>
    </header>

    <!-- Main Container -->
    <main id="app" class="w-full max-w-4xl p-4 mt-20 mb-8 flex-grow flex flex-col items-center justify-center relative z-0 min-h-[calc(100vh-8rem)]">
        <!-- Контент рендериться тут -->
    </main>

    <!-- Modal Overlay -->
    <div id="modal-overlay" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden flex items-center justify-center p-4 backdrop-blur-sm transition-all">
        <div class="bg-white rounded-2xl shadow-2xl max-w-sm w-full p-6 transform transition-all scale-100 animate-bounce-small">
            <div class="text-center mb-6">
                <div class="w-16 h-16 bg-yellow-100 rounded-full flex items-center justify-center mx-auto mb-4 text-yellow-600 shadow-sm">
                    <i class="fa-solid fa-circle-exclamation text-3xl"></i>
                </div>
                <h3 class="text-xl font-bold text-slate-800 mb-2">Зачекай!</h3>
                <p class="text-slate-500 text-sm leading-relaxed">
                    Ти відповів не на всі питання. <br>
                    Якщо завершити зараз, пропущені питання будуть зараховані як <b>неправильні</b>.
                </p>
            </div>
            <div class="flex flex-col sm:flex-row gap-3">
                <button onclick="app.closeModal(true)" class="flex-1 py-3 px-4 rounded-xl font-bold text-slate-600 bg-slate-100 hover:bg-slate-200 transition-colors whitespace-nowrap">
                    Повернутись
                </button>
                <button onclick="app.finishQuiz(true)" class="flex-1 py-3 px-4 rounded-xl font-bold text-white bg-red-500 hover:bg-red-600 transition-colors shadow-lg shadow-red-200">
                    Все одно завершити
                </button>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="w-full bg-slate-200 p-3 text-center text-xs text-slate-500 mt-auto no-print">
        Система тестування для початкової школи &copy; 2025
    </footer>

    <script>
        // ==========================================
        // 1. БАЗА ДАНИХ (CONTENT)
        // ==========================================
        const db = {
            1: {
                title: "1 Клас",
                color: "bg-blue-500",
                topics: [
                    {
                        id: "1_basics",
                        title: "Комп'ютер та його складові",
                        icon: "fa-desktop",
                        questions: [
                            { 
                                q: "Що ми використовуємо, щоб вводити текст?", 
                                a: ["Клавіатура", "Мишка", "Екран", "Принтер"], 
                                c: 0,
                                ex: "Клавіатура має багато клавіш і спеціально призначена для набору тексту."
                            },
                            { 
                                q: "На чому ми бачимо зображення?", 
                                a: ["Монітор", "Клавіатура", "Системний блок", "Мишка"], 
                                c: 0,
                                ex: "Монітор — це екран, на якому відображається все, що робить комп'ютер."
                            },
                            { 
                                q: "Який пристрій схожий на маленьку тваринку?", 
                                a: ["Мишка", "Монітор", "Кабель", "Флешка"], 
                                c: 0,
                                ex: "Комп'ютерна мишка отримала назву через свою форму та «хвостик»-дріт."
                            },
                            { 
                                q: "Що потрібно, щоб комп'ютер запрацював?", 
                                a: ["Електрика", "Вода", "Сонце", "Вітер"], 
                                c: 0,
                                ex: "Комп'ютер — електричний пристрій, тому йому потрібне живлення від електромережі."
                            },
                            { 
                                q: "Де зберігаються всі програми?", 
                                a: ["У системному блоці", "У мишці", "На килимку", "У клавіатурі"], 
                                c: 0,
                                ex: "Усі програми записані в пам'яті комп'ютера, яка знаходиться в системному блоці."
                            },
                            { 
                                q: "Якою кнопкою ми вмикаємо комп'ютер?", 
                                a: ["Power (Живлення)", "Space (Пробіл)", "Enter", "Esc"], 
                                c: 0,
                                ex: "Кнопка Power зображена як кружечок з рискою — це стандартний знак увімкнення."
                            },
                            { 
                                q: "Що робить принтер?", 
                                a: ["Друкує на папері", "Грає музику", "Показує мультики", "Охолоджує кімнату"], 
                                c: 0,
                                ex: "Принтер переносить зображення та текст із комп'ютера на папір."
                            },
                            { 
                                q: "Для чого потрібні навушники?", 
                                a: ["Слухати звук", "Дивитися відео", "Друкувати", "Малювати"], 
                                c: 0,
                                ex: "Навушники передають звук тільки тобі, щоб іншим не заважати."
                            },
                            { 
                                q: "Чи можна їсти за комп'ютером?", 
                                a: ["Ні", "Так", "Тільки цукерки", "Тільки суп"], 
                                c: 0,
                                ex: "Крихти та напої можуть зіпсувати клавіатуру й інші частини комп'ютера."
                            },
                            { 
                                q: "Що це: маленький пристрій для перенесення інформації?", 
                                a: ["Флешка", "Диск", "Книжка", "Ручка"], 
                                c: 0,
                                ex: "Флешку легко переносити, і вона може зберігати багато файлів."
                            },
                            { 
                                q: "Головний 'мозок' комп'ютера - це...", 
                                a: ["Процесор", "Клавіатура", "Екран", "Дріт"], 
                                c: 0,
                                ex: "Процесор виконує всі обчислення та керує роботою інших частин."
                            },
                            { 
                                q: "Навіщо натискати мишкою?", 
                                a: ["Щоб керувати", "Щоб вимкнути світло", "Щоб писати літери", "Просто так"], 
                                c: 0,
                                ex: "Мишка допомагає обирати об'єкти на екрані та керувати програмами."
                            },
                            { 
                                q: "Як називається стрілочка на екрані?", 
                                a: ["Курсор", "Паличка", "Вказівник", "Лінія"], 
                                c: 0,
                                ex: "Курсор показує, де саме на екрані буде дія — клік або набір тексту."
                            },
                            { 
                                q: "Що не є частиною комп'ютера?", 
                                a: ["Чайник", "Монітор", "Мишка", "Клавіатура"], 
                                c: 0,
                                ex: "Чайник — це побутовий прилад, він не відноситься до комп'ютера."
                            },
                            { 
                                q: "Ноутбук - це...", 
                                a: ["Переносний комп'ютер", "Планшет", "Телефон", "Телевізор"], 
                                c: 0,
                                ex: "Ноутбук має всі частини комп'ютера, але в одному корпусі та працює від батареї."
                            },
                            { 
                                q: "Що ми робимо очима, дивлячись на екран?", 
                                a: ["Отримуємо інформацію", "Гріємось", "Спимо", "Танцюємо"], 
                                c: 0,
                                ex: "Через очі ми сприймаємо зорову інформацію з монітора."
                            },
                            { 
                                q: "Смартфон - це теж комп'ютер?", 
                                a: ["Так", "Ні", "Це іграшка", "Це просто телефон"], 
                                c: 0,
                                ex: "Смартфон має процесор, пам'ять і програми, як і комп'ютер."
                            },
                            { 
                                q: "Що таке 'Іконка' на екрані?", 
                                a: ["Маленька картинка програми", "Фотографія", "Пляма", "Кнопка вимкнення"], 
                                c: 0,
                                ex: "Іконка — це маленький малюнок, який запускає програму або відкриває файл."
                            },
                            { 
                                q: "Як потрібно сидіти за комп'ютером?", 
                                a: ["Рівно", "Лежачи", "Криво", "Стоячи на голові"], 
                                c: 0,
                                ex: "Рівна постава допомагає не перевантажувати спину та очі."
                            },
                            { 
                                q: "Чи можна чіпати дроти мокрими руками?", 
                                a: ["Ніколи", "Можна", "Інколи", "Тільки один раз"], 
                                c: 0,
                                ex: "Мокрі руки й електрика — дуже небезпечно для здоров'я."
                            }
                        ]
                    }
                ]
            },
            2: {
                title: "2 Клас",
                color: "bg-green-500",
                topics: [
                    {
                        id: "2_info",
                        title: "Інформація та повідомлення",
                        icon: "fa-comments",
                        questions: [
                            { 
                                q: "Інформація - це...", 
                                a: ["Відомості про світ", "Тільки картинки", "Музика", "Ігри"], 
                                c: 0,
                                ex: "Інформація — це будь-які відомості, які ми отримуємо, зберігаємо чи передаємо."
                            },
                            { 
                                q: "Яким органом чуття ми сприймаємо музику?", 
                                a: ["Вухами", "Очима", "Носом", "Руками"], 
                                c: 0,
                                ex: "Музику ми чуємо, тому її сприймають вуха."
                            },
                            { 
                                q: "Яку інформацію ми отримуємо, коли їмо лимон?", 
                                a: ["Смакову", "Зорову", "Слухову", "Нюхову"], 
                                c: 0,
                                ex: "Кислий смак лимона — це приклад смакової інформації."
                            },
                            { 
                                q: "Світлофор передає інформацію...", 
                                a: ["Зорову", "Смакову", "Слухову", "Текстову"], 
                                c: 0,
                                ex: "Ми дивимося на кольори світлофора очима, тому це зорова інформація."
                            },
                            { 
                                q: "Книжка містить...", 
                                a: ["Текстову та графічну інформацію", "Тільки звукову", "Смакову", "Ніяку"], 
                                c: 0,
                                ex: "У книзі є текст і малюнки — це текстова та графічна інформація."
                            },
                            { 
                                q: "Шум дощу - це яка інформація?", 
                                a: ["Слухова", "Зорова", "Смакова", "Нюхова"], 
                                c: 0,
                                ex: "Ми чуємо дощ, тому це слухова інформація."
                            },
                            { 
                                q: "Чи є жест привітання інформацією?", 
                                a: ["Так", "Ні", "Не знаю", "Це просто рух"], 
                                c: 0,
                                ex: "Жест показує, що людина вітається — це теж повідомлення, тобто інформація."
                            },
                            { 
                                q: "Хто може передавати інформацію?", 
                                a: ["Люди і пристрої", "Тільки комп'ютер", "Тільки вчитель", "Тільки книги"], 
                                c: 0,
                                ex: "І люди, і техніка можуть надсилати й отримувати інформацію."
                            },
                            { 
                                q: "Що ми робимо, коли розповідаємо вірш?", 
                                a: ["Передаємо інформацію", "Зберігаємо інформацію", "Обробляємо", "Видаляємо"], 
                                c: 0,
                                ex: "Коли говоримо вголос, ми передаємо те, що знаємо, іншим."
                            },
                            { 
                                q: "Що ми робимо, коли записуємо задачу в зошит?", 
                                a: ["Зберігаємо інформацію", "Передаємо", "Шукаємо", "Втрачаємо"], 
                                c: 0,
                                ex: "Запис у зошиті допомагає зберегти інформацію, щоб не забути."
                            },
                            { 
                                q: "Що таке 'хибна' інформація?", 
                                a: ["Неправдива", "Цікава", "Корисна", "Смачна"], 
                                c: 0,
                                ex: "Хибна інформація — це така, що не відповідає дійсності."
                            },
                            { 
                                q: "Чи можна довіряти всьому в Інтернеті?", 
                                a: ["Ні", "Так", "Завжди", "Тільки картинкам"], 
                                c: 0,
                                ex: "В Інтернеті є помилки та обман, тому інформацію треба перевіряти."
                            },
                            { 
                                q: "Приклад числової інформації:", 
                                a: ["Приклад '2+2'", "Малюнок кота", "Пісня", "Слово 'Мама'"], 
                                c: 0,
                                ex: "Числа й приклади — це числова інформація."
                            },
                            { 
                                q: "Приклад графічної інформації:", 
                                a: ["Фотографія", "Текст", "Мелодія", "Число"], 
                                c: 0,
                                ex: "Фотографія, малюнок чи схема — це графічна інформація."
                            },
                            { 
                                q: "Щоб зберегти малюнок надовго, його треба...", 
                                a: ["Записати або намалювати", "Промовити", "З'їсти", "Забути"], 
                                c: 0,
                                ex: "Якщо ми щось записали або намалювали — це можна переглянути пізніше."
                            },
                            { 
                                q: "Телефонний дзвінок - це...", 
                                a: ["Передача інформації", "Обробка", "Зберігання", "Видалення"], 
                                c: 0,
                                ex: "Коли говоримо по телефону, ми передаємо інформацію на відстань."
                            },
                            { 
                                q: "Комп'ютер обробляє інформацію за допомогою...", 
                                a: ["Програм", "Монітора", "Мишки", "Корпусу"], 
                                c: 0,
                                ex: "Програми підказують комп'ютеру, що саме робити з інформацією."
                            },
                            { 
                                q: "Запах квітів - це інформація...", 
                                a: ["Нюхова", "Смакова", "Дотикова", "Зорова"], 
                                c: 0,
                                ex: "Коли відчуваємо запах, ми сприймаємо нюхову інформацію."
                            },
                            { 
                                q: "Чи є сон джерелом інформації?", 
                                a: ["Так", "Ні", "Не знаю", "Це мультик"], 
                                c: 0,
                                ex: "Сон може підказувати відчуття чи думки, але це не надійне джерело фактів, як книга або вчитель."
                            },
                            { 
                                q: "Повідомлення можуть бути...", 
                                a: ["Усні та письмові", "Тільки письмові", "Тільки усні", "Жодні"], 
                                c: 0,
                                ex: "Ми можемо передавати інформацію голосом або через текст — це усні й письмові повідомлення."
                            }
                        ]
                    }
                ]
            },
            3: {
                title: "3 Клас",
                color: "bg-yellow-500",
                topics: [
                    {
                        id: "3_algo",
                        title: "Алгоритми та виконавці",
                        icon: "fa-robot",
                        questions: [
                            { 
                                q: "Що таке алгоритм?", 
                                a: ["Послідовність дій", "Загадка", "Вірш", "Малюнок"], 
                                c: 0,
                                ex: "Алгоритм — це чіткий план, що робити крок за кроком."
                            },
                            { 
                                q: "Хто такий виконавець?", 
                                a: ["Той, хто виконує команди", "Той, хто пише музику", "Вчитель", "Директор"], 
                                c: 0,
                                ex: "Виконавець — це хтось (або щось), хто виконує задані команди."
                            },
                            { 
                                q: "Комп'ютер - це виконавець?", 
                                a: ["Так", "Ні", "Інколи", "Він сам по собі"], 
                                c: 0,
                                ex: "Комп'ютер сам не вигадує дії, він виконує те, що ми йому наказали програмою."
                            },
                            { 
                                q: "Яка команда правильна для робота: 'Іди' чи 'Іди 5 кроків'?", 
                                a: ["Іди 5 кроків", "Іди", "Будь ласка, йди", "Ходи"], 
                                c: 0,
                                ex: "Команда має бути точною: робот має знати, скільки саме кроків зробити."
                            },
                            { 
                                q: "Система команд виконавця - це...", 
                                a: ["Всі команди, які він розуміє", "Будь-які слова", "Тільки одна команда", "Список покупок"], 
                                c: 0,
                                ex: "Кожен виконавець має свій набір команд, які він може виконати."
                            },
                            { 
                                q: "Алгоритм приготування чаю починається з...", 
                                a: ["Набрати води", "Випити чай", "Помити чашку", "Вимкнути чайник"], 
                                c: 0,
                                ex: "Спочатку потрібна вода — без неї чай не звариш."
                            },
                            { 
                                q: "Скретч (Scratch) - це...", 
                                a: ["Середовище програмування", "Гра-стрілялка", "Назва кота", "Мультфільм"], 
                                c: 0,
                                ex: "Scratch — це спеціальна програма, де діти вчаться створювати власні проєкти з командами."
                            },
                            { 
                                q: "У Скретч команди збираються як...", 
                                a: ["Блоки лего", "Рядки тексту", "Малюнки", "Ноти"], 
                                c: 0,
                                ex: "Команди у Scratch схожі на кольорові блоки, які з'єднуються одна з одною."
                            },
                            { 
                                q: "Блок \"Коли прапорець натиснуто\" означає...", 
                                a: ["Старт програми", "Кінець програми", "Пауза", "Помилка"], 
                                c: 0,
                                ex: "Коли натискають зелений прапорець, усі скрипти з цим блоком запускаються."
                            },
                            { 
                                q: "Спрайт у Скретч - це...", 
                                a: ["Герой/об'єкт", "Напій", "Фон", "Кнопка"], 
                                c: 0,
                                ex: "Спрайт — це персонаж або об'єкт, який рухається та виконує команди."
                            },
                            { 
                                q: "Сцена у Скретч - це...", 
                                a: ["Місце подій", "Список команд", "Меню", "Костюм"], 
                                c: 0,
                                ex: "Сцена — це фон, на якому розгортаються події."
                            },
                            { 
                                q: "Лінійний алгоритм виконується...", 
                                a: ["По черзі, команда за командою", "Тільки одна команда", "Як заманеться", "З кінця"], 
                                c: 0,
                                ex: "У лінійному алгоритмі кожна команда йде строго за попередньою."
                            },
                            { 
                                q: "Команда 'Повторити 10 разів' - це...", 
                                a: ["Цикл", "Розгалуження", "Помилка", "Зупинка"], 
                                c: 0,
                                ex: "Цикл дозволяє виконати одну й ту саму дію багато разів."
                            },
                            { 
                                q: "Якщо в алгоритмі є умова 'ЯКЩО', це...", 
                                a: ["Розгалуження", "Лінійний алгоритм", "Цикл", "Повторення"], 
                                c: 0,
                                ex: "Розгалуження означає: якщо умова виконується — робимо одну дію, інакше — іншу."
                            },
                            { 
                                q: "Чи може людина бути виконавцем?", 
                                a: ["Так", "Ні", "Тільки доросла", "Тільки дитина"], 
                                c: 0,
                                ex: "Людина теж може виконувати чіткі команди за алгоритмом."
                            },
                            { 
                                q: "Чи може пральна машина бути виконавцем?", 
                                a: ["Так", "Ні", "Тільки якщо попросити", "Вона не жива"], 
                                c: 0,
                                ex: "Пральна машина виконує програму прання — це теж виконавець."
                            },
                            { 
                                q: "Алгоритм переходу вулиці починається з...", 
                                a: ["Зупинись", "Біжи", "Закрий очі", "Кричи"], 
                                c: 0,
                                ex: "Щоб перейти дорогу безпечно, спочатку треба зупинитися й подивитися по сторонах."
                            },
                            { 
                                q: "Графічний спосіб запису алгоритму - це...", 
                                a: ["Блок-схема", "Твір", "Пісня", "Таблиця"], 
                                c: 0,
                                ex: "Блок-схема показує кроки алгоритму за допомогою фігур та стрілок."
                            },
                            { 
                                q: "Блок у вигляді ромба в блок-схемі означає...", 
                                a: ["Умову", "Початок", "Дію", "Кінець"], 
                                c: 0,
                                ex: "Ромб у блок-схемі — це перевірка умови: «так» чи «ні»."
                            },
                            { 
                                q: "Чи можна порушувати порядок дій в алгоритмі?", 
                                a: ["Ні, це призведе до помилки", "Так, нічого не зміниться", "Можна, якщо хочеться", "Завжди"], 
                                c: 0,
                                ex: "Якщо змінити порядок кроків, результат може виявитися неправильним."
                            }
                        ]
                    }
                ]
            },
            4: {
                title: "4 Клас",
                color: "bg-purple-600",
                topics: [
                    {
                        id: "4_safe",
                        title: "Безпека в Інтернеті",
                        icon: "fa-shield-halved",
                        questions: [
                            { 
                                q: "Що таке логін?", 
                                a: ["Ваше ім'я в системі", "Секретний код", "Адреса будинку", "Номер телефону"], 
                                c: 0,
                                ex: "Логін — це ім'я користувача, за яким система тебе впізнає."
                            },
                            { 
                                q: "Що таке пароль?", 
                                a: ["Секретний ключ для входу", "Всім відоме слово", "Назва сайту", "Ваше прізвище"], 
                                c: 0,
                                ex: "Пароль знаєш тільки ти — він захищає твій акаунт від інших."
                            },
                            { 
                                q: "Який пароль надійний?", 
                                a: ["Xy7#mP92", "123456", "qwerty", "password"], 
                                c: 0,
                                ex: "Надійний пароль містить букви, цифри й символи та складно вгадується."
                            },
                            { 
                                q: "Чи можна повідомляти пароль друзям?", 
                                a: ["Ні", "Так", "Тільки найкращим", "Тільки однокласникам"], 
                                c: 0,
                                ex: "Пароль не можна нікому говорити, навіть друзям."
                            },
                            { 
                                q: "Що таке комп'ютерний вірус?", 
                                a: ["Шкідлива програма", "Хвороба монітора", "Бруд на мишці", "Погана гра"], 
                                c: 0,
                                ex: "Вірус — це програма, яка шкодить комп'ютеру або викрадає дані."
                            },
                            { 
                                q: "Що захищає комп'ютер від вірусів?", 
                                a: ["Антивірус", "Серветка", "Пароль", "Інтернет"], 
                                c: 0,
                                ex: "Антивірусна програма знаходить і блокує шкідливі файли."
                            },
                            { 
                                q: "Чи можна відкривати листи від незнайомців?", 
                                a: ["Ні, це небезпечно", "Так, там подарунки", "Завжди", "Якщо гарна тема"], 
                                c: 0,
                                ex: "У листах від незнайомців можуть бути віруси або обман."
                            },
                            { 
                                q: "Що таке 'спам'?", 
                                a: ["Небажана реклама", "Смачна їжа", "Корисний лист", "Важливе повідомлення"], 
                                c: 0,
                                ex: "Спам — це купа небажаних листів, часто рекламних або підозрілих."
                            },
                            { 
                                q: "Чи можна писати свою домашню адресу в чатах?", 
                                a: ["Ні", "Так", "Якщо спитають", "Тільки в іграх"], 
                                c: 0,
                                ex: "Домашня адреса — це конфіденційна інформація, її не можна писати у відкритих чатах."
                            },
                            { 
                                q: "Що робити, якщо незнайомець погрожує в Інтернеті?", 
                                a: ["Сказати батькам", "Відповісти грубо", "Плакати", "Видалити комп'ютер"], 
                                c: 0,
                                ex: "У такій ситуації важливо не мовчати і розповісти дорослим."
                            },
                            { 
                                q: "Нікнейм - це...", 
                                a: ["Псевдонім у мережі", "Справжнє ім'я", "Прізвище", "Адреса"], 
                                c: 0,
                                ex: "Нікнейм — вигадане ім'я, яке ти використовуєш в Інтернеті."
                            },
                            { 
                                q: "Авторське право захищає...", 
                                a: ["Твори авторів", "Тільки гроші", "Паролі", "Віруси"], 
                                c: 0,
                                ex: "Авторське право означає, що не можна просто так копіювати й видавати чужі твори за свої."
                            },
                            { 
                                q: "Чи можна качати будь-які ігри безкоштовно?", 
                                a: ["Ні, це піратство", "Так, всі так роблять", "Якщо ніхто не бачить", "Завжди"], 
                                c: 0,
                                ex: "Безкоштовне скачування платних ігор без дозволу — це порушення закону."
                            },
                            { 
                                q: "Фішинг - це...", 
                                a: ["Крадіжка даних через підробні сайти", "Риболовля", "Вид спорту", "Налаштування екрану"], 
                                c: 0,
                                ex: "Фішинг намагається виманити логіни й паролі через фальшиві сторінки."
                            },
                            { 
                                q: "Скільки часу корисно проводити за комп'ютером?", 
                                a: ["Обмежено, з перервами", "Весь день", "Всю ніч", "24 години"], 
                                c: 0,
                                ex: "Тривале сидіння за комп'ютером шкідливе для очей і здоров'я, потрібні перерви."
                            },
                            { 
                                q: "Яка інформація є приватною?", 
                                a: ["Телефон, адреса, пароль", "Погода", "Новини", "Розклад уроків"], 
                                c: 0,
                                ex: "Телефон, адреса й паролі — це персональні дані, їх не можна розголошувати."
                            },
                            { 
                                q: "Гугл (Google) - це...", 
                                a: ["Пошукова система", "Соціальна мережа", "Іграшка", "Магазин"], 
                                c: 0,
                                ex: "Google допомагає шукати інформацію в Інтернеті."
                            },
                            { 
                                q: "Що робити перед вимкненням комп'ютера?", 
                                a: ["Закрити програми", "Вимкнути з розетки", "Нічого", "Натиснути на екран"], 
                                c: 0,
                                ex: "Правильно спочатку закрити програми, а потім вимкнути комп'ютер."
                            },
                            { 
                                q: "Чи все в Інтернеті правда?", 
                                a: ["Ні, треба перевіряти", "Так, абсолютно", "Тільки у Вікіпедії", "Тільки в Ютубі"], 
                                c: 0,
                                ex: "В Інтернеті можуть бути вигадки, тому важливо перевіряти інформацію з кількох джерел."
                            },
                            { 
                                q: "Етикет в Інтернеті означає...", 
                                a: ["Бути ввічливим", "Писати великими літерами", "Ображати всіх", "Спамити"], 
                                c: 0,
                                ex: "Мережевий етикет — це повага до інших, культурне спілкування онлайн."
                            }
                        ]
                    }
                ]
            }
        };

        // ==========================================
        // 2. СТАН ДОДАТКУ (STATE)
        // ==========================================
        const appState = {
            classId: null,
            topic: null,
            questions: [], 
            currentQuestionIndex: 0,
            userAnswers: [], 
            score: 0,
            maxQuestions: 12
        };

        const dom = {
            header: document.getElementById('header-status'),
            main: document.getElementById('app'),
            modal: document.getElementById('modal-overlay')
        };

        // ==========================================
        // 3. ДОПОМІЖНІ ФУНКЦІЇ (HELPERS)
        // ==========================================
        const utils = {
            // Алгоритм Фішера-Йейтса для перемішування масиву
            shuffle: (array) => {
                for (let i = array.length - 1; i > 0; i--) {
                    const j = Math.floor(Math.random() * (i + 1));
                    [array[i], array[j]] = [array[j], array[i]];
                }
                return array;
            }
        };

        // ==========================================
        // 4. ОСНОВНИЙ ДОДАТОК (LOGIC)
        // ==========================================
        const app = {
            init: function() {
                this.renderClassSelection();
            },

            // --- Навігація ---
            goHome: function() {
                if (appState.topic) {
                    if (confirm('Повернутися на головну? Весь прогрес буде втрачено.')) {
                        this.renderClassSelection();
                    }
                } else {
                    this.renderClassSelection();
                }
            },

            selectClass: function(id) {
                appState.classId = id;
                this.renderTopicSelection();
            },

            // --- Екран 1: Вибір Класу ---
            renderClassSelection: function() {
                // Скидання стану
                appState.classId = null;
                appState.topic = null;
                appState.questions = [];
                
                dom.header.textContent = "Оберіть клас";
                
                let html = `
                    <div class="w-full max-w-3xl fade-in flex flex-col items-center">
                        <h2 class="text-3xl font-bold text-center mb-4 text-slate-700 w-full">Обери свій клас</h2>
                        <p class="text-center text-slate-500 max-w-2xl mb-8 text-sm sm:text-base">
                            Це онлайн-тести з інформатики для учнів 1–4 класів. 
                            Батьки можуть самостійно перевірити, як дитина розуміє тему, 
                            а вчителі — використати тести як додатковий інструмент моніторингу знань.
                        </p>
                        <div class="grid grid-cols-1 sm:grid-cols-2 gap-6 w-full max-w-2xl">
                `;

                for (const [id, data] of Object.entries(db)) {
                    html += `
                        <button onclick="app.selectClass(${id})" 
                            class="${data.color} hover-scale text-white p-8 rounded-2xl shadow-lg flex flex-col items-center justify-center gap-4 fade-in transform transition-all hover:shadow-xl">
                            <span class="text-6xl font-black">${id}</span>
                            <span class="text-xl font-bold uppercase tracking-wider">Клас</span>
                        </button>
                    `;
                }
                html += `
                        </div>
                    </div>
                `;
                dom.main.innerHTML = html;
            },

            // --- Екран 2: Вибір Теми ---
            renderTopicSelection: function() {
                const classData = db[appState.classId];
                dom.header.innerHTML = `<span class="text-slate-400 font-normal">Клас ${appState.classId} / </span> Теми`;
                
                let html = `
                    <div class="w-full max-w-4xl flex justify-between items-center mb-6 fade-in">
                        <button onclick="app.renderClassSelection()" class="text-slate-500 hover:text-slate-800 font-bold transition-colors">
                            <i class="fa-solid fa-arrow-left mr-2"></i> Назад
                        </button>
                        <span class="bg-blue-100 text-blue-800 py-1 px-3 rounded-full text-sm font-bold">
                            Доступно тем: ${classData.topics.length}
                        </span>
                    </div>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 w-full max-w-4xl fade-in">
                `;

                classData.topics.forEach((topic) => {
                    html += `
                        <div onclick="app.prepareAndStartQuiz('${topic.id}')" 
                            class="bg-white border-2 border-slate-100 p-6 rounded-xl shadow-sm hover:shadow-md hover:border-blue-400 cursor-pointer transition-all flex items-center gap-4 group">
                            <div class="w-16 h-16 rounded-full bg-slate-100 flex items-center justify-center group-hover:bg-blue-100 transition-colors text-slate-500 group-hover:text-blue-600 flex-shrink-0">
                                <i class="fa-solid ${topic.icon} text-3xl"></i>
                            </div>
                            <div>
                                <h3 class="font-bold text-lg text-slate-700 group-hover:text-blue-600 transition-colors">${topic.title}</h3>
                                <p class="text-sm text-slate-400 mt-1">${topic.questions.length} питань у базі</p>
                            </div>
                        </div>
                    `;
                });

                html += `</div>`;
                dom.main.innerHTML = html;
            },

            // --- Логіка Тесту ---
            prepareAndStartQuiz: function(topicId) {
                const classData = db[appState.classId];
                const topicData = classData.topics.find(t => t.id === topicId);
                
                appState.topic = topicData;
                appState.score = 0;
                appState.currentQuestionIndex = 0;
                
                // 1. Копіюємо та перемішуємо всі питання
                const allQuestions = [...topicData.questions];
                utils.shuffle(allQuestions);
                
                // 2. Беремо потрібну кількість (наприклад, 12)
                const rawQuestions = allQuestions.slice(0, appState.maxQuestions);
                
                // 3. Формуємо об'єкти питань з перемішаними відповідями
                appState.questions = rawQuestions.map(q => {
                    let options = q.a.map((ansText, idx) => ({
                        text: ansText,
                        isCorrect: idx === q.c
                    }));
                    
                    utils.shuffle(options);

                    return {
                        q: q.q,
                        options: options,
                        explanation: q.ex || null
                    };
                });

                // 4. Ініціалізуємо масив відповідей користувача (null = немає відповіді)
                appState.userAnswers = new Array(appState.questions.length).fill(null);
                
                this.renderQuestion();
            },

            // --- Екран 3: Питання ---
            renderQuestion: function() {
                const q = appState.questions[appState.currentQuestionIndex];
                const total = appState.questions.length;
                const current = appState.currentQuestionIndex + 1;
                const selectedOptionIndex = appState.userAnswers[appState.currentQuestionIndex];

                dom.header.textContent = `Питання ${current} із ${total}`;

                // Пагінація (кульки зверху)
                let paginationHtml = `<div class="flex flex-wrap justify-center gap-2 mb-6 w-full max-w-2xl px-2">`;
                appState.userAnswers.forEach((ans, idx) => {
                    let colorClass = "bg-slate-200 text-slate-400 hover:bg-slate-300";
                    
                    if (idx === appState.currentQuestionIndex) {
                        colorClass = "bg-blue-600 text-white ring-4 ring-blue-100 shadow-lg scale-110";
                    } else if (ans !== null) {
                        colorClass = "bg-green-100 text-green-600 border border-green-200 hover:bg-green-200";
                    }
                    
                    paginationHtml += `
                        <button onclick="app.jumpToQuestion(${idx})" class="w-8 h-8 rounded-full text-xs font-bold transition-all duration-200 ${colorClass}">
                            ${idx + 1}
                        </button>
                    `;
                });
                paginationHtml += `</div>`;

                // Варіанти відповідей
                const optionsHtml = q.options.map((opt, idx) => {
                    const isSelected = selectedOptionIndex === idx;
                    
                    let btnClass = isSelected 
                        ? "bg-blue-50 border-2 border-blue-500 text-blue-800 shadow-md ring-2 ring-blue-100" 
                        : "bg-white border-2 border-slate-100 hover:border-blue-300 hover:bg-blue-50 text-slate-600";
                    
                    let circleClass = isSelected
                        ? "bg-blue-200 text-blue-700"
                        : "bg-slate-100 text-slate-500";
                    
                    let icon = isSelected
                        ? '<i class="fa-solid fa-circle-check text-blue-600 ml-auto text-xl animate-pulse"></i>'
                        : '';

                    return `
                    <button onclick="app.selectAnswer(${idx})" 
                        class="w-full text-left p-4 rounded-xl font-bold transition-all duration-200 text-lg flex items-center mb-3 ${btnClass}">
                        <div class="w-8 h-8 rounded-full flex items-center justify-center mr-4 font-bold text-sm flex-shrink-0 transition-colors ${circleClass}">
                            ${String.fromCharCode(65 + idx)}
                        </div>
                        <span class="mr-2">${opt.text}</span>
                        ${icon}
                    </button>
                    `;
                }).join('');

                // Кнопки навігації
                const isLastQuestion = appState.currentQuestionIndex === total - 1;
                const nextButtonHtml = isLastQuestion 
                    ? `<button onclick="app.tryFinishQuiz()" class="flex-1 py-3 rounded-xl font-bold text-white bg-green-500 hover:bg-green-600 shadow-lg shadow-green-200 transition-all hover:scale-105 active:scale-95 flex items-center justify-center gap-2">
                        Завершити <i class="fa-solid fa-flag-checkered"></i>
                       </button>`
                    : `<button onclick="app.nextQuestion()" class="flex-1 py-3 rounded-xl font-bold text-white bg-blue-600 hover:bg-blue-700 shadow-lg shadow-blue-200 transition-all hover:scale-105 active:scale-95 flex items-center justify-center gap-2">
                        Далі <i class="fa-solid fa-arrow-right"></i>
                       </button>`;

                let html = `
                    <div class="w-full max-w-2xl fade-in flex flex-col items-center">
                        ${paginationHtml}

                        <div class="bg-white w-full rounded-2xl shadow-xl p-6 sm:p-10 border-b-4 border-slate-200 mb-6">
                            <h3 class="text-xl sm:text-2xl font-bold text-slate-800 mb-8 text-center leading-relaxed">
                                ${q.q}
                            </h3>

                            <div class="w-full">
                                ${optionsHtml}
                            </div>
                        </div>

                        <div class="flex justify-between items-center w-full gap-4">
                            <button onclick="app.prevQuestion()" 
                                class="flex-1 py-3 rounded-xl font-bold text-slate-600 bg-white border border-slate-200 hover:bg-slate-50 shadow-sm transition-all hover:scale-105 disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:scale-100"
                                ${appState.currentQuestionIndex === 0 ? 'disabled' : ''}>
                                <i class="fa-solid fa-arrow-left mr-2"></i> Назад
                            </button>
                            ${nextButtonHtml}
                        </div>
                    </div>
                `;
                dom.main.innerHTML = html;
            },

            selectAnswer: function(optionIdx) {
                appState.userAnswers[appState.currentQuestionIndex] = optionIdx;
                this.renderQuestion();
            },

            jumpToQuestion: function(idx) {
                appState.currentQuestionIndex = idx;
                this.renderQuestion();
            },

            nextQuestion: function() {
                if (appState.currentQuestionIndex < appState.questions.length - 1) {
                    appState.currentQuestionIndex++;
                    this.renderQuestion();
                }
            },

            prevQuestion: function() {
                if (appState.currentQuestionIndex > 0) {
                    appState.currentQuestionIndex--;
                    this.renderQuestion();
                }
            },

            // --- Логіка завершення ---
            tryFinishQuiz: function() {
                const hasUnanswered = appState.userAnswers.includes(null);
                
                if (hasUnanswered) {
                    dom.modal.classList.remove('hidden');
                } else {
                    this.finishQuiz(false);
                }
            },

            closeModal: function(jumpToMissing = false) {
                dom.modal.classList.add('hidden');
                if (jumpToMissing) {
                    const firstMissing = appState.userAnswers.indexOf(null);
                    if (firstMissing !== -1) {
                        this.jumpToQuestion(firstMissing);
                    }
                }
            },

            finishQuiz: function(forceEnd) {
                if(forceEnd) {
                    this.closeModal(false);
                }

                // Підрахунок балів
                appState.score = 0;
                appState.questions.forEach((q, qIdx) => {
                    const userSelectedIdx = appState.userAnswers[qIdx];
                    if (userSelectedIdx !== null) {
                        if (q.options[userSelectedIdx].isCorrect) {
                            appState.score++;
                        }
                    }
                });

                this.renderResult();
            },

            // --- Екран 4: Результат ---
            renderResult: function() {
                dom.header.textContent = "Результат тестування";
                const percentage = Math.round((appState.score / appState.questions.length) * 100);
                
                let message, color, icon, bgIcon;

                if (percentage >= 90) {
                    message = "Чудово! Ти справжній експерт!";
                    color = "text-green-500";
                    icon = "fa-trophy";
                    bgIcon = "bg-green-100";
                } else if (percentage >= 60) {
                    message = "Добре! Ти багато знаєш!";
                    color = "text-blue-500";
                    icon = "fa-thumbs-up";
                    bgIcon = "bg-blue-100";
                } else {
                    message = "Спробуй ще раз! У тебе вийде!";
                    color = "text-orange-500";
                    icon = "fa-lightbulb";
                    bgIcon = "bg-orange-100";
                }

                // Детальний аналіз
                let detailsHtml = '<div class="w-full max-w-2xl mt-8 space-y-4 text-left">';
                appState.questions.forEach((q, idx) => {
                    const userIdx = appState.userAnswers[idx];
                    const userOption = userIdx !== null ? q.options[userIdx] : null;
                    const correctOption = q.options.find(o => o.isCorrect);
                    const isCorrect = userOption && userOption.isCorrect;
                    
                    const borderColor = isCorrect ? 'border-green-500' : 'border-red-500';
                    const iconStatus = isCorrect 
                        ? '<i class="fa-solid fa-check text-green-500 text-xl"></i>'
                        : '<i class="fa-solid fa-xmark text-red-500 text-xl"></i>';

                    const explanationHtml = q.explanation
                        ? `
                        <div class="text-slate-600 bg-slate-50 p-2 rounded-lg border border-slate-100">
                            <span class="font-bold">Пояснення:</span> ${q.explanation}
                        </div>
                        `
                        : '';

                    detailsHtml += `
                        <div class="bg-white p-5 rounded-xl border-l-8 ${borderColor} shadow-sm flex gap-4 items-start">
                            <div class="pt-1">${iconStatus}</div>
                            <div class="flex-grow">
                                <div class="font-bold text-slate-700 mb-2 text-lg">
                                    <span class="text-slate-400 mr-2 text-sm">#${idx + 1}</span>${q.q}
                                </div>
                                <div class="text-sm space-y-1">
                                    ${!isCorrect ? `
                                        <div class="text-red-600 bg-red-50 p-2 rounded-lg border border-red-100">
                                            <span class="font-bold">Твоя відповідь:</span> ${userOption ? userOption.text : 'Пропущено'}
                                        </div>
                                    ` : ''}
                                    <div class="text-green-700 bg-green-50 p-2 rounded-lg border border-green-100">
                                        <span class="font-bold">Правильно:</span> ${correctOption.text}
                                    </div>
                                    ${explanationHtml}
                                </div>
                            </div>
                        </div>
                    `;
                });
                detailsHtml += '</div>';

                let html = `
                    <div class="flex flex-col items-center w-full fade-in pb-10">
                        <div class="bg-white rounded-3xl shadow-xl p-8 text-center max-w-md w-full mb-8 relative overflow-hidden">
                            <!-- Шапка ТІЛЬКИ ДЛЯ ПРИНТУ -->
                            <div class="print-only mb-6 text-left">
                                <h1 class="text-2xl font-bold mb-1">Тест з інформатики</h1>
                                <p>Клас: ${appState.classId}</p>
                                <p>Тема: ${appState.topic.title}</p>
                                <p>Дата проходження: ${new Date().toLocaleDateString('uk-UA')}</p>
                                <p>Результат: ${percentage}% (${appState.score} із ${appState.questions.length})</p>
                            </div>

                            <div class="absolute top-0 left-0 w-full h-2 ${color.replace('text', 'bg')}"></div>
                            
                            <div class="w-24 h-24 rounded-full ${bgIcon} mx-auto flex items-center justify-center mb-6 shadow-inner">
                                <i class="fa-solid ${icon} ${color} text-5xl"></i>
                            </div>
                            
                            <h2 class="text-4xl font-black text-slate-800 mb-2 tracking-tight">${percentage}%</h2>
                            <p class="text-slate-500 mb-3 font-medium">
                                Правильних відповідей: <span class="text-slate-800 font-bold">${appState.score}</span> із ${appState.questions.length}
                            </p>
                            
                            <div class="text-xl font-bold ${color} mb-4 px-4">
                                ${message}
                            </div>

                            <div class="text-left text-sm text-slate-500 bg-slate-50 border border-slate-100 rounded-2xl p-4 mb-6">
                                <p class="font-bold mb-1">Як читати результат:</p>
                                <ul class="space-y-1 list-disc list-inside">
                                    <li><span class="font-semibold">0–50%</span> — варто повторити тему разом із дорослим.</li>
                                    <li><span class="font-semibold">50–80%</span> — базовий рівень, є окремі прогалини.</li>
                                    <li><span class="font-semibold">80–100%</span> — високий рівень засвоєння теми.</li>
                                </ul>
                            </div>

                            <div class="flex flex-col gap-3 no-print">
                                <button onclick="app.prepareAndStartQuiz('${appState.topic.id}')" 
                                    class="w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-3.5 px-6 rounded-xl transition-all shadow-lg shadow-blue-200 hover:shadow-blue-300 transform hover:-translate-y-0.5">
                                    <i class="fa-solid fa-rotate-right mr-2"></i> Пройти ще раз
                                </button>
                                <button onclick="app.renderClassSelection()" 
                                    class="w-full bg-slate-100 hover:bg-slate-200 text-slate-700 font-bold py-3.5 px-6 rounded-xl transition-colors border border-slate-200">
                                    <i class="fa-solid fa-house mr-2"></i> На головну
                                </button>
                            </div>
                        </div>
                        
                        <div class="w-full max-w-2xl text-center mb-4">
                             <h3 class="text-xl font-bold text-slate-500 uppercase tracking-widest text-sm">Аналіз помилок</h3>
                        </div>
                        ${detailsHtml}
                        
                        <div class="mt-8 no-print">
                            <button onclick="window.print()" class="text-slate-400 hover:text-slate-600 text-sm font-semibold flex items-center gap-2 transition-colors">
                                <i class="fa-solid fa-print"></i> Роздрукувати або зберегти в PDF
                            </button>
                        </div>
                    </div>
                `;
                dom.main.innerHTML = html;
            }
        };

        // Запуск додатку
        app.init();
        
    </script>
</body>
</html>
