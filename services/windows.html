<!DOCTYPE html>
<html lang="uk">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Тренажер роботи з вікнами програм</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css"
        integrity="sha512-SnH5WK+bZxgPHs44uWIX+LLJAJ9/2PkPKZ5QiAj6Ta86w+fsb2TkcmfRyVX3pBnMFcV7oQPJkl9QevSCWr3W6A=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />

    <!-- Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-N8T05K3NGT"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());
        gtag('config', 'G-N8T05K3NGT');
    </script>

    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            height: 100vh;
            overflow: hidden;
            position: relative;
        }

        .desktop {
            width: 100%;
            height: 100%;
            position: relative;
            background-image:
                radial-gradient(circle at 20% 80%, rgba(120, 119, 198, 0.3), transparent 50%),
                radial-gradient(circle at 80% 20%, rgba(255, 119, 198, 0.15), transparent 50%);
        }

        .control-panel {
            position: fixed;
            top: 20px;
            left: 20px;
            z-index: 1000;
            background: rgba(255, 255, 255, 0.95);
            padding: 15px;
            border-radius: 12px;
            box-shadow: 0 8px 32px rgba(31, 38, 135, 0.37);
            backdrop-filter: blur(8px);
            border: 1px solid rgba(255, 255, 255, 0.18);
            width: 280px;
        }

        .stats {
            display: flex;
            gap: 20px;
            margin-bottom: 15px;
        }

        .stat {
            text-align: center;
            flex-grow: 1;
        }

        .stat-value {
            font-size: 24px;
            font-weight: bold;
            color: #667eea;
        }

        .stat-label {
            font-size: 12px;
            color: #666;
            text-transform: uppercase;
        }

        .main-controls {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
        }

        .btn {
            background: linear-gradient(145deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
            flex-grow: 1;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.4);
        }

        .lang-switcher {
            display: flex;
            gap: 5px;
        }

        .lang-btn {
            background: #e0e0e0;
            border: 1px solid #ccc;
            padding: 5px 8px;
            border-radius: 6px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.2s ease;
        }

        .lang-btn:hover {
            background: #ccc;
        }

        .lang-btn.active {
            background: #667eea;
            color: white;
            border-color: #667eea;
        }

        .window {
            position: absolute;
            min-width: 300px;
            min-height: 200px;
            background: #ffffff;
            border-radius: 8px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.2);
            overflow: hidden;
            transition: all 0.3s ease;
            border: 1px solid #e0e0e0;
        }

        .window.minimized {
            transform: scale(0.1);
            opacity: 0;
            pointer-events: none;
        }

        .window.maximized {
            top: 0 !important;
            left: 0 !important;
            width: 100vw !important;
            height: 100vh !important;
            border-radius: 0;
            z-index: 999;
        }

        .window-header {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            padding: 12px 16px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            cursor: move;
            border-bottom: 1px solid #e0e0e0;
            user-select: none;
        }

        .window-title {
            display: flex;
            align-items: center;
            gap: 10px;
            font-weight: 600;
            color: #333;
        }

        .window-icon {
            width: 20px;
            height: 20px;
            font-size: 16px;
            text-align: center;
        }

        .window-controls {
            display: flex;
            gap: 8px;
        }

        .window-control {
            width: 28px;
            height: 28px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s ease;
            font-size: 14px;
        }

        .minimize {
            background: #ffd700;
            color: #333;
        }

        .minimize:hover {
            background: #ffed4a;
            transform: scale(1.1);
        }

        .maximize {
            background: #28a745;
            color: white;
        }

        .maximize:hover {
            background: #34ce57;
            transform: scale(1.1);
        }

        .close {
            background: #dc3545;
            color: white;
        }

        .close:hover {
            background: #e74c3c;
            transform: scale(1.1);
        }

        .window-content {
            padding: 20px;
            height: calc(100% - 60px);
            background: #fafafa;
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .progress-bar {
            width: 100%;
            height: 6px;
            background: #e0e0e0;
            border-radius: 3px;
            overflow: hidden;
            margin-top: 10px;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #667eea, #764ba2);
            width: 0%;
        }

        @keyframes windowAppear {
            from {
                transform: scale(0.8) rotate(5deg);
                opacity: 0;
            }

            to {
                transform: scale(1) rotate(0deg);
                opacity: 1;
            }
        }

        .window {
            animation: windowAppear 0.5s ease;
        }

        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: #28a745;
            color: white;
            padding: 12px 20px;
            border-radius: 8px;
            box-shadow: 0 4px 15px rgba(40, 167, 69, 0.3);
            z-index: 1002;
            transform: translateX(calc(100% + 20px));
            transition: all 0.4s cubic-bezier(0.68, -0.55, 0.27, 1.55);
        }

        .notification.show {
            transform: translateX(0);
        }

        .notification.error {
            background: #dc3545;
            box-shadow: 0 4px 15px rgba(220, 53, 69, 0.3);
        }

        .notification.info {
            background: #17a2b8;
            box-shadow: 0 4px 15px rgba(23, 162, 184, 0.3);
            min-width: 300px;
            text-align: center;
        }

        .notification-content {
            white-space: pre-line;
        }

        .notification-close-btn {
            background: none;
            border: none;
            color: white;
            font-size: 20px;
            position: absolute;
            top: 5px;
            right: 10px;
            cursor: pointer;
        }
    </style>
</head>

<body>
    <div class="desktop" id="desktop">
        <div class="control-panel">
            <div class="stats">
                <div class="stat">
                    <div class="stat-value" id="score">0</div>
                    <div class="stat-label" data-translate-key="score">Рахунок</div>
                </div>
                <div class="stat">
                    <div class="stat-value" id="level">1</div>
                    <div class="stat-label" data-translate-key="level">Рівень</div>
                </div>
                <div class="stat">
                    <div class="stat-value" id="streak">0</div>
                    <div class="stat-label" data-translate-key="streak">Серія</div>
                </div>
            </div>
            <div class="main-controls">
                <button id="startGameBtn" class="btn" data-translate-key="startGame">Почати гру</button>
                <button id="stopGameBtn" class="btn" data-translate-key="stopGame" style="display: none;">Зупинити
                    гру</button>
                <div class="lang-switcher">
                    <button id="lang-uk" class="lang-btn active">UK</button>
                    <button id="lang-en" class="lang-btn">EN</button>
                </div>
            </div>
            <div class="progress-bar">
                <div class="progress-fill" id="progressFill"></div>
            </div>
        </div>

    </div>

    <script>
        class WindowTrainer {
            constructor() {
                this.score = 0;
                this.level = 1;
                this.streak = 0;
                this.currentTask = null;
                this.timeLimit = 8000; // 8 секунд
                this.timer = null;
                this.isGameActive = false;
                this.currentLanguage = 'uk';

                this.apps = [
                    { name: 'TextEditor Pro', icon: '<i class="fa-solid fa-file-alt"></i>', color: '#4CAF50' },
                    { name: 'Calculator Plus', icon: '<i class="fa-solid fa-calculator"></i>', color: '#2196F3' },
                    { name: 'Photo Viewer', icon: '<i class="fa-solid fa-image"></i>', color: '#FF9800' },
                    { name: 'Music Player', icon: '<i class="fa-solid fa-music"></i>', color: '#E91E63' },
                    { name: 'File Manager', icon: '<i class="fa-solid fa-folder-open"></i>', color: '#607D8B' },
                    { name: 'Browser X', icon: '<i class="fa-solid fa-globe"></i>', color: '#009688' },
                    { name: 'Email Client', icon: '<i class="fa-solid fa-envelope"></i>', color: '#3F51B5' },
                    { name: 'Video Player', icon: '<i class="fa-solid fa-film"></i>', color: '#F44336' },
                    { name: 'Code Editor', icon: '<i class="fa-solid fa-code"></i>', color: '#795548' },
                    { name: 'Paint Studio', icon: '<i class="fa-solid fa-palette"></i>', color: '#9C27B0' }
                ];

                this.tasks = ['close', 'minimize', 'maximize'];

                this.taskIcons = {
                    close: '<i class="fa-solid fa-xmark"></i>',
                    minimize: '<i class="fa-solid fa-window-minimize"></i>',
                    maximize: '<i class="fa-regular fa-square"></i>'
                };

                this.translations = {
                    uk: {
                        score: 'Рахунок',
                        level: 'Рівень',
                        streak: 'Серія',
                        startGame: 'Почати гру',
                        stopGame: 'Зупинити гру',
                        playAgain: 'Зіграти знову',
                        gameInProgress: 'Гра йде...',
                        welcome: 'Вітаємо в',
                        description: 'Це вікно навчальної програми для тренування навичок роботи з вікнами операційної системи.',
                        currentTaskTitle: 'Поточне завдання:',
                        tasks: {
                            close: 'Закрийте це вікно',
                            minimize: 'Згорніть це вікно',
                            maximize: 'Розгорніть це вікно'
                        },
                        notifyCorrect: 'Правильно!',
                        notifyPoints: 'балів',
                        notifyIncorrect: 'Неправильно! Спробуйте ще раз',
                        notifyTimeout: 'Час вийшов!',
                        gameOverTitle: 'Гру закінчено!',
                        gameOverScore: 'Ваш рахунок',
                        gameOverLevel: 'Досягнутий рівень',
                        gameOverStreak: 'Найдовша серія'
                    },
                    en: {
                        score: 'Score',
                        level: 'Level',
                        streak: 'Streak',
                        startGame: 'Start Game',
                        stopGame: 'Stop Game',
                        playAgain: 'Play Again',
                        gameInProgress: 'In Progress...',
                        welcome: 'Welcome to',
                        description: 'This is a window of a training application for practicing skills with operating system windows.',
                        currentTaskTitle: 'Current task:',
                        tasks: {
                            close: 'Close this window',
                            minimize: 'Minimize this window',
                            maximize: 'Maximize this window'
                        },
                        notifyCorrect: 'Correct!',
                        notifyPoints: 'points',
                        notifyIncorrect: 'Incorrect! Try again',
                        notifyTimeout: 'Time is up!',
                        gameOverTitle: 'Game Over!',
                        gameOverScore: 'Your Score',
                        gameOverLevel: 'Level Reached',
                        gameOverStreak: 'Longest Streak'
                    }
                };

                window.addEventListener('resize', () => this.handleResize());
                this.setLanguage(this.currentLanguage);
            }

            setLanguage(lang) {
                this.currentLanguage = lang;
                document.querySelectorAll('[data-translate-key]').forEach(el => {
                    const key = el.dataset.translateKey;
                    el.textContent = this.translations[lang][key];
                });

                document.getElementById('lang-uk').classList.toggle('active', lang === 'uk');
                document.getElementById('lang-en').classList.toggle('active', lang === 'en');

                if (this.isGameActive) {
                    this.clearTimer(); // Clear timer and reset progress bar
                    this.updateStats(); // Update stats in the new language
                } else {
                    const btn = document.getElementById('startGameBtn');
                    btn.textContent = this.translations[this.currentLanguage].startGame;
                }
            }

            startGame() {
                if (this.isGameActive) return;
                this.isGameActive = true;
                document.getElementById('startGameBtn').style.display = 'none';
                document.getElementById('stopGameBtn').style.display = 'block';
                this.score = 0;
                this.level = 1;
                this.streak = 0;
                this.timeLimit = 8000;
                this.updateStats();
                const gameOverNotification = document.querySelector('.notification.info');
                if (gameOverNotification) {
                    gameOverNotification.remove();
                }
                this.createWindow();
            }

            stopGame() {
                this.isGameActive = false;
                this.clearTimer(); // Call a new method to clear the timer and reset the progress bar
                const existingWindows = document.querySelectorAll('.window');
                existingWindows.forEach(w => w.remove());
                document.getElementById('startGameBtn').style.display = 'block';
                document.getElementById('startGameBtn').textContent = this.translations[this.currentLanguage].playAgain;
                document.getElementById('stopGameBtn').style.display = 'none';

                this.showNotification(
                    `<h3>${this.translations[this.currentLanguage].gameOverTitle}</h3>
                    <p>${this.translations[this.currentLanguage].gameOverScore}: ${this.score}</p>
                    <p>${this.translations[this.currentLanguage].gameOverLevel}: ${this.level}</p>
                    <p>${this.translations[this.currentLanguage].gameOverStreak}: ${this.streak}</p>
                    <button class="notification-close-btn"><i class="fa-solid fa-xmark"></i></button>`,
                    'info',
                    0 // Duration 0 means it won't auto-close
                );

                document.querySelector('.notification-close-btn').addEventListener('click', (e) => {
                    e.target.closest('.notification').remove();
                });
            }

            createWindow() {
                if (!this.isGameActive) return;

                const existingWindows = document.querySelectorAll('.window');
                existingWindows.forEach(w => w.remove());

                const app = this.apps[Math.floor(Math.random() * this.apps.length)];
                const task = this.tasks[Math.floor(Math.random() * this.tasks.length)];

                this.currentTask = task;

                const windowEl = document.createElement('div');
                windowEl.className = 'window';
                windowEl.style.left = Math.random() * (window.innerWidth - 450) + 'px';
                windowEl.style.top = Math.random() * (window.innerHeight - 350) + 'px';
                windowEl.style.width = '420px';
                windowEl.style.height = '320px';

                const T = this.translations[this.currentLanguage];

                windowEl.innerHTML = `
                    <div class="window-header">
                        <div class="window-title">
                            <span class="window-icon">${app.icon}</span>
                            <span>${app.name}</span>
                        </div>
                        <div class="window-controls">
                            <button class="window-control minimize" title="Згорнути" aria-label="${T.tasks.minimize}">${this.taskIcons.minimize}</button>
                            <button class="window-control maximize" title="Розгорнути" aria-label="${T.tasks.maximize}">${this.taskIcons.maximize}</button>
                            <button class="window-control close" title="Закрити" aria-label="${T.tasks.close}">${this.taskIcons.close}</button>
                        </div>
                    </div>
                    <div class="window-content" style="background: linear-gradient(135deg, ${app.color}20, ${app.color}10);">
                        <h3>${T.welcome} ${app.name}!</h3>
                        <p>${T.description}</p>
                        <div style="background: white; padding: 15px; border-radius: 8px; margin-top: 10px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                            <h4>${T.currentTaskTitle}</h4>
                            <p style="color: ${app.color}; font-weight: bold; font-size: 16px;">${T.tasks[task]}</p>
                        </div>
                        <div style="margin-top: auto; padding: 10px; background: rgba(255,255,255,0.7); border-radius: 6px;">
                            <small>${T.level}: ${this.level} | ${T.score}: ${this.score}</small>
                        </div>
                    </div>
                `;

                windowEl.querySelector('.minimize').addEventListener('click', () => this.handleAction('minimize'));
                windowEl.querySelector('.maximize').addEventListener('click', () => this.handleAction('maximize'));
                windowEl.querySelector('.close').addEventListener('click', () => this.handleAction('close'));

                document.getElementById('desktop').appendChild(windowEl);

                this.startTimer();
                this.makeDraggable(windowEl);
            }

            startTimer() {
                const progressFill = document.getElementById('progressFill');
                progressFill.style.transition = 'none';
                progressFill.style.width = '100%';

                setTimeout(() => {
                    progressFill.style.transition = `width ${this.timeLimit / 1000}s linear`;
                    progressFill.style.width = '0%';
                }, 50);

                this.timer = setTimeout(() => {
                    this.handleTimeout();
                }, this.timeLimit);
            }

            clearTimer() {
                clearTimeout(this.timer);
                const progressFill = document.getElementById('progressFill');
                progressFill.style.transition = 'none';
                progressFill.style.width = '100%'; // Reset to full to hide the bar
            }

            handleAction(action) {
                if (!this.isGameActive) return;

                this.clearTimer(); // Clear timer when action is taken

                const windowEl = document.querySelector('.window');
                if (!windowEl) return;

                if (action === this.currentTask) {
                    this.handleCorrectAction(action, windowEl);
                } else {
                    this.handleIncorrectAction(windowEl);
                }
            }

            handleCorrectAction(action, windowEl) {
                this.score += (10 * this.level);
                this.streak++;

                if (this.streak >= 5) {
                    this.level++;
                    this.streak = 0;
                    this.timeLimit = Math.max(4000, this.timeLimit - 150); // Змінено поріг та крок зменшення
                }

                this.updateStats();
                const T = this.translations[this.currentLanguage];
                this.showNotification(`${T.notifyCorrect} +${10 * this.level} ${T.notifyPoints}`, 'success');

                switch (action) {
                    case 'close':
                        windowEl.style.transform = 'scale(0) rotate(180deg)';
                        windowEl.style.opacity = '0';
                        break;
                    case 'minimize':
                        windowEl.classList.add('minimized');
                        break;
                    case 'maximize':
                        windowEl.classList.add('maximized');
                        break;
                }

                setTimeout(() => {
                    windowEl.remove();
                    this.createWindow();
                }, 500);
            }

            handleIncorrectAction(windowEl) {
                this.streak = 0;
                this.updateStats();
                this.showNotification(this.translations[this.currentLanguage].notifyIncorrect, 'error');

                windowEl.style.transition = 'transform 0.5s ease';
                windowEl.style.transform = 'translateX(-10px)';
                setTimeout(() => { windowEl.style.transform = 'translateX(10px)'; }, 100);
                setTimeout(() => { windowEl.style.transform = 'translateX(-10px)'; }, 200);
                setTimeout(() => { windowEl.style.transform = 'translateX(0px)'; }, 300);

                setTimeout(() => this.createWindow(), 1000);
            }

            handleTimeout() {
                this.streak = 0;
                this.updateStats();
                this.showNotification(this.translations[this.currentLanguage].notifyTimeout, 'error');

                const windowEl = document.querySelector('.window');
                if (windowEl) {
                    windowEl.style.opacity = '0.5';
                    setTimeout(() => this.createWindow(), 1000);
                }
            }

            updateStats() {
                document.getElementById('score').textContent = this.score;
                document.getElementById('level').textContent = this.level;
                document.getElementById('streak').textContent = this.streak;
            }

            showNotification(message, type = 'success', duration = 2500) {
                const notification = document.createElement('div');
                notification.className = `notification ${type}`;
                notification.innerHTML = `<div class="notification-content">${message}</div>`;
                document.body.appendChild(notification);

                setTimeout(() => notification.classList.add('show'), 10);

                if (duration > 0) {
                    setTimeout(() => {
                        notification.classList.remove('show');
                        setTimeout(() => notification.remove(), 400);
                    }, duration);
                }
            }

            makeDraggable(element) {
                const header = element.querySelector('.window-header');
                let isDragging = false;
                let startX, startY, initialX, initialY;

                header.addEventListener('mousedown', (e) => {
                    if (e.target.closest('.window-control') || element.classList.contains('maximized')) return;

                    isDragging = true;
                    startX = e.clientX;
                    startY = e.clientY;
                    initialX = element.offsetLeft;
                    initialY = element.offsetTop;
                    let maxZIndex = 0;
                    document.querySelectorAll('.window').forEach(win => {
                        const zIndex = parseInt(win.style.zIndex) || 0;
                        if (zIndex > maxZIndex) {
                            maxZIndex = zIndex;
                        }
                    });
                    element.style.zIndex = maxZIndex + 1;
                });

                document.addEventListener('mousemove', (e) => {
                    if (!isDragging) return;
                    const deltaX = e.clientX - startX;
                    const deltaY = e.clientY - startY;
                    element.style.left = (initialX + deltaX) + 'px';
                    element.style.top = (initialY + deltaY) + 'px';
                });

                document.addEventListener('mouseup', () => isDragging = false);
            }

            handleResize() {
                const windows = document.querySelectorAll('.window');
                windows.forEach(windowEl => {
                    const rect = windowEl.getBoundingClientRect();
                    if (rect.right > window.innerWidth) {
                        windowEl.style.left = (window.innerWidth - rect.width) + 'px';
                    }
                    if (rect.bottom > window.innerHeight) {
                        windowEl.style.top = (window.innerHeight - rect.height) + 'px';
                    }
                    if (rect.left < 0) {
                        windowEl.style.left = '0px';
                    }
                    if (rect.top < 0) {
                        windowEl.style.top = '0px';
                    }
                });
            }
        }

        const trainer = new WindowTrainer();
        document.getElementById('startGameBtn').addEventListener('click', () => trainer.startGame());
        document.getElementById('stopGameBtn').addEventListener('click', () => trainer.stopGame());
        document.getElementById('lang-uk').addEventListener('click', () => trainer.setLanguage('uk'));
        document.getElementById('lang-en').addEventListener('click', () => trainer.setLanguage('en'));
    </script>
</body>

</html>